import{innerFrom}from"../observable/innerFrom";import{operate}from"../util/lift";import{createOperatorSubscriber}from"./OperatorSubscriber";function switchMap(u,p){return operate((r,i)=>{let b=null,c=0,e=!1,n=()=>e&&!b&&i.complete();r.subscribe(createOperatorSubscriber(i,e=>{null!=b&&b.unsubscribe();let t=0,o=c++;innerFrom(u(e,o)).subscribe(b=createOperatorSubscriber(i,r=>i.next(p?p(e,r,o,t++):r),()=>{b=null,n()}))},()=>{e=!0,n()}))})}export{switchMap};