import{map}from"./map";import{innerFrom}from"../observable/innerFrom";import{operate}from"../util/lift";import{createOperatorSubscriber}from"./OperatorSubscriber";function exhaustMap(i,p){return p?r=>r.pipe(exhaustMap((o,t)=>innerFrom(i(o,t)).pipe(map((r,e)=>p(o,r,t,e))))):operate((r,e)=>{let o=0,t=null,p=!1;r.subscribe(createOperatorSubscriber(e,r=>{t||(t=createOperatorSubscriber(e,void 0,()=>{t=null,p&&e.complete()}),innerFrom(i(r,o++)).subscribe(t))},()=>{p=!0,t||e.complete()}))})}export{exhaustMap};