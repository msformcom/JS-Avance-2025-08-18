import{asyncScheduler}from"../scheduler/async";import{isValidDate}from"../util/isDate";import{operate}from"../util/lift";import{innerFrom}from"../observable/innerFrom";import{createErrorClass}from"../util/createErrorClass";import{createOperatorSubscriber}from"./OperatorSubscriber";import{executeSchedule}from"../util/executeSchedule";var TimeoutError=createErrorClass(function(e){return function(r){void 0===r&&(r=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=r}});function timeout(r,e){var r=isValidDate(r)?{first:r}:"number"==typeof r?{each:r}:r,c=r.first,l=r.each,t=r.with,s=void 0===t?timeoutErrorFactory:t,t=r.scheduler,a=void 0===t?null!=e?e:asyncScheduler:t,e=r.meta,m=void 0===e?null:e;if(null==c&&null==l)throw new TypeError("No timeout provided.");return operate(function(r,e){function t(r){o=executeSchedule(e,a,function(){try{n.unsubscribe(),innerFrom(s({meta:m,lastValue:i,seen:u})).subscribe(e)}catch(r){e.error(r)}},r)}var o,i=null,u=0,n=r.subscribe(createOperatorSubscriber(e,function(r){null!=o&&o.unsubscribe(),u++,e.next(i=r),0<l&&t(l)},void 0,void 0,function(){null!=o&&o.closed||null!=o&&o.unsubscribe(),i=null}));u||t(null!=c?"number"==typeof c?c:+c-a.now():l)})}function timeoutErrorFactory(r){throw new TimeoutError(r)}export{TimeoutError,timeout};