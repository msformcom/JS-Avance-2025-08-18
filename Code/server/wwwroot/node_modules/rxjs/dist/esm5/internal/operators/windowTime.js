import{Subject}from"../Subject";import{asyncScheduler}from"../scheduler/async";import{Subscription}from"../Subscription";import{operate}from"../util/lift";import{createOperatorSubscriber}from"./OperatorSubscriber";import{arrRemove}from"../util/arrRemove";import{popScheduler}from"../util/args";import{executeSchedule}from"../util/executeSchedule";function windowTime(s){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var f=null!=(e=popScheduler(r))?e:asyncScheduler,p=null!=(e=r[0])?e:null,a=r[1]||1/0;return operate(function(e,u){function n(r){l(function(e){e=e.window;return r(e)}),r(u),u.unsubscribe()}var t=[],o=!1,c=function(e){var r=e.window,n=e.subs;r.complete(),n.unsubscribe(),arrRemove(t,e),o&&i()},i=function(){var e,r,n;t&&(e=new Subscription,u.add(e),r=new Subject,t.push(n={window:r,subs:e,seen:0}),u.next(r.asObservable()),executeSchedule(e,f,function(){return c(n)},s))},l=(null!==p&&0<=p?executeSchedule(u,f,i,p,!0):o=!0,i(),function(e){return t.slice().forEach(e)});return e.subscribe(createOperatorSubscriber(u,function(r){l(function(e){e.window.next(r),a<=++e.seen&&c(e)})},function(){return n(function(e){return e.complete()})},function(r){return n(function(e){return e.error(r)})})),function(){t=null}})}export{windowTime};