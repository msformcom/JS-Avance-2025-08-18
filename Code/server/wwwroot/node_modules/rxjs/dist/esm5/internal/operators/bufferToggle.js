import{__values}from"tslib";import{Subscription}from"../Subscription";import{operate}from"../util/lift";import{innerFrom}from"../observable/innerFrom";import{createOperatorSubscriber}from"./OperatorSubscriber";import{noop}from"../util/noop";import{arrRemove}from"../util/arrRemove";function bufferToggle(e,i){return operate(function(r,t){var n=[];innerFrom(e).subscribe(createOperatorSubscriber(t,function(r){var e=[],o=(n.push(e),new Subscription);o.add(innerFrom(i(r)).subscribe(createOperatorSubscriber(t,function(){arrRemove(n,e),t.next(e),o.unsubscribe()},noop)))},noop)),r.subscribe(createOperatorSubscriber(t,function(r){var e,o;try{for(var t=__values(n),i=t.next();!i.done;i=t.next())i.value.push(r)}catch(r){e={error:r}}finally{try{i&&!i.done&&(o=t.return)&&o.call(t)}finally{if(e)throw e.error}}},function(){for(;0<n.length;)t.next(n.shift());t.complete()}))})}export{bufferToggle};