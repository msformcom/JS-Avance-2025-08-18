var __read=this&&this.__read||function(r,e){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var t,i,o=n.call(r),u=[];try{for(;(void 0===e||0<e--)&&!(t=o.next()).done;)u.push(t.value)}catch(r){i={error:r}}finally{try{t&&!t.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},__spreadArray=this&&this.__spreadArray||function(r,e){for(var n=0,t=e.length,i=r.length;n<t;n++,i++)r[i]=e[n];return r},innerFrom_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.share=void 0,require("../observable/innerFrom")),Subject_1=require("../Subject"),Subscriber_1=require("../Subscriber"),lift_1=require("../util/lift");function share(r){var e=(r=void 0===r?{}:r).connector,f=void 0===e?function(){return new Subject_1.Subject}:e,e=r.resetOnError,d=void 0===e||e,e=r.resetOnComplete,_=void 0===e||e,e=r.resetOnRefCountZero,v=void 0===e||e;return function(r){function t(){var r=i;b(),null!=r&&r.unsubscribe()}var i,o,u,s=0,c=!1,a=!1,l=function(){null!=o&&o.unsubscribe(),o=void 0},b=function(){l(),i=u=void 0,c=a=!1};return lift_1.operate(function(r,e){s++,a||c||l();var n=u=null!=u?u:f();e.add(function(){0!==--s||a||c||(o=handleReset(t,v))}),n.subscribe(e),!i&&0<s&&(i=new Subscriber_1.SafeSubscriber({next:function(r){return n.next(r)},error:function(r){a=!0,l(),o=handleReset(b,d,r),n.error(r)},complete:function(){c=!0,l(),o=handleReset(b,_),n.complete()}}),innerFrom_1.innerFrom(r).subscribe(i))})(r)}}function handleReset(r,e){for(var n,t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];if(!0===e)r();else if(!1!==e)return n=new Subscriber_1.SafeSubscriber({next:function(){n.unsubscribe(),r()}}),innerFrom_1.innerFrom(e.apply(void 0,__spreadArray([],__read(t)))).subscribe(n)}exports.share=share;