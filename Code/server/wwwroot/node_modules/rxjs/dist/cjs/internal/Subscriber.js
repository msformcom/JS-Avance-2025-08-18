var __extends=this&&this.__extends||(()=>{var o=function(t,r){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,r){t.__proto__=r}:function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}})(),isFunction_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.EMPTY_OBSERVER=exports.SafeSubscriber=exports.Subscriber=void 0,require("./util/isFunction")),Subscription_1=require("./Subscription"),config_1=require("./config"),reportUnhandledError_1=require("./util/reportUnhandledError"),noop_1=require("./util/noop"),NotificationFactories_1=require("./NotificationFactories"),timeoutProvider_1=require("./scheduler/timeoutProvider"),errorContext_1=require("./util/errorContext"),Subscriber=(e=>{function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Subscription_1.isSubscription(t)&&t.add(r)):r.destination=exports.EMPTY_OBSERVER,r}return __extends(t,e),t.create=function(t,r,e){return new SafeSubscriber(t,r,e)},t.prototype.next=function(t){this.isStopped?handleStoppedNotification(NotificationFactories_1.nextNotification(t),this):this._next(t)},t.prototype.error=function(t){this.isStopped?handleStoppedNotification(NotificationFactories_1.errorNotification(t),this):(this.isStopped=!0,this._error(t))},t.prototype.complete=function(){this.isStopped?handleStoppedNotification(NotificationFactories_1.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(t){this.destination.next(t)},t.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(Subscription_1.Subscription),_bind=(exports.Subscriber=Subscriber,Function.prototype.bind);function bind(t,r){return _bind.call(t,r)}var ConsumerObserver=(()=>{function t(t){this.partialObserver=t}return t.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(t){handleUnhandledError(t)}},t.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(t){handleUnhandledError(t)}else handleUnhandledError(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){handleUnhandledError(t)}},t})(),SafeSubscriber=(i=>{function t(t,r,e){var o=i.call(this)||this;return e=isFunction_1.isFunction(t)||!t?{next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=e?e:void 0}:o&&config_1.config.useDeprecatedNextContext?((r=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},{next:t.next&&bind(t.next,r),error:t.error&&bind(t.error,r),complete:t.complete&&bind(t.complete,r)}):t,o.destination=new ConsumerObserver(e),o}return __extends(t,i),t})(Subscriber);function handleUnhandledError(t){config_1.config.useDeprecatedSynchronousErrorHandling?errorContext_1.captureError(t):reportUnhandledError_1.reportUnhandledError(t)}function defaultErrorHandler(t){throw t}function handleStoppedNotification(t,r){var e=config_1.config.onStoppedNotification;e&&timeoutProvider_1.timeoutProvider.setTimeout(function(){return e(t,r)})}exports.SafeSubscriber=SafeSubscriber,exports.EMPTY_OBSERVER={closed:!0,next:noop_1.noop,error:defaultErrorHandler,complete:noop_1.noop};