var __values=this&&this.__values||function(r){var i="function"==typeof Symbol&&Symbol.iterator,e=i&&r[i],t=0;if(e)return e.call(r);if(r&&"number"==typeof r.length)return{next:function(){return{value:(r=r&&t>=r.length?void 0:r)&&r[t++],done:!r}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(r,i){var e="function"==typeof Symbol&&r[Symbol.iterator];if(!e)return r;var t,n,o=e.call(r),s=[];try{for(;(void 0===i||0<i--)&&!(t=o.next()).done;)s.push(t.value)}catch(r){n={error:r}}finally{try{t&&!t.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return s},__spreadArray=this&&this.__spreadArray||function(r,i){for(var e=0,t=i.length,n=r.length;e<t;e++,n++)r[n]=i[e];return r},isFunction_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.isSubscription=exports.EMPTY_SUBSCRIPTION=exports.Subscription=void 0,require("./util/isFunction")),UnsubscriptionError_1=require("./util/UnsubscriptionError"),arrRemove_1=require("./util/arrRemove"),Subscription=(()=>{function e(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}var r;return e.prototype.unsubscribe=function(){var i,r,e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t))try{for(var n=__values(t),o=n.next();!o.done;o=n.next())o.value.remove(this)}catch(r){a={error:r}}finally{try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}else t.remove(this);var s=this.initialTeardown;if(isFunction_1.isFunction(s))try{s()}catch(r){e=r instanceof UnsubscriptionError_1.UnsubscriptionError?r.errors:[r]}var a=this._finalizers;if(a){this._finalizers=null;try{for(var u=__values(a),c=u.next();!c.done;c=u.next()){var l=c.value;try{execFinalizer(l)}catch(r){e=null!=e?e:[],r instanceof UnsubscriptionError_1.UnsubscriptionError?e=__spreadArray(__spreadArray([],__read(e)),__read(r.errors)):e.push(r)}}}catch(r){i={error:r}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(i)throw i.error}}}if(e)throw new UnsubscriptionError_1.UnsubscriptionError(e)}},e.prototype.add=function(r){var i;if(r&&r!==this)if(this.closed)execFinalizer(r);else{if(r instanceof e){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=null!=(i=this._finalizers)?i:[]).push(r)}},e.prototype._hasParent=function(r){var i=this._parentage;return i===r||Array.isArray(i)&&i.includes(r)},e.prototype._addParent=function(r){var i=this._parentage;this._parentage=Array.isArray(i)?(i.push(r),i):i?[i,r]:r},e.prototype._removeParent=function(r){var i=this._parentage;i===r?this._parentage=null:Array.isArray(i)&&arrRemove_1.arrRemove(i,r)},e.prototype.remove=function(r){var i=this._finalizers;i&&arrRemove_1.arrRemove(i,r),r instanceof e&&r._removeParent(this)},e.EMPTY=((r=new e).closed=!0,r),e})();function isSubscription(r){return r instanceof Subscription||r&&"closed"in r&&isFunction_1.isFunction(r.remove)&&isFunction_1.isFunction(r.add)&&isFunction_1.isFunction(r.unsubscribe)}function execFinalizer(r){isFunction_1.isFunction(r)?r():r.unsubscribe()}exports.Subscription=Subscription,exports.EMPTY_SUBSCRIPTION=Subscription.EMPTY,exports.isSubscription=isSubscription;