var __values=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,u=r&&e[r],t=0;if(u)return u.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&t>=e.length?void 0:e)&&e[t++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},Subscription_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferTime=void 0,require("../Subscription")),lift_1=require("../util/lift"),OperatorSubscriber_1=require("./OperatorSubscriber"),arrRemove_1=require("../util/arrRemove"),async_1=require("../scheduler/async"),args_1=require("../util/args"),executeSchedule_1=require("../util/executeSchedule");function bufferTime(i){for(var e,r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];var l=null!=(e=args_1.popScheduler(r))?e:async_1.asyncScheduler,o=null!=(e=r[0])?e:null,s=r[1]||1/0;return lift_1.operate(function(e,u){var c=[],t=!1,f=function(e){var r=e.buffer;e.subs.unsubscribe(),arrRemove_1.arrRemove(c,e),u.next(r),t&&n()},n=function(){var e,r;c&&(e=new Subscription_1.Subscription,u.add(e),c.push(r={buffer:[],subs:e}),executeSchedule_1.executeSchedule(e,l,function(){return f(r)},i))},r=(null!==o&&0<=o?executeSchedule_1.executeSchedule(u,l,n,o,!0):t=!0,n(),OperatorSubscriber_1.createOperatorSubscriber(u,function(e){var r,u,t=c.slice();try{for(var n=__values(t),i=n.next();!i.done;i=n.next()){var l=i.value,o=l.buffer;o.push(e),s<=o.length&&f(l)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(r)throw r.error}}},function(){for(;null!=c&&c.length;)u.next(c.shift().buffer);null!=r&&r.unsubscribe(),u.complete(),u.unsubscribe()},void 0,function(){return c=null}));e.subscribe(r)})}exports.bufferTime=bufferTime;