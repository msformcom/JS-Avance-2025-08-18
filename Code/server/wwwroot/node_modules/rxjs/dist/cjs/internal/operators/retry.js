Object.defineProperty(exports,"__esModule",{value:!0}),exports.retry=void 0;var lift_1=require("../util/lift"),OperatorSubscriber_1=require("./OperatorSubscriber"),identity_1=require("../util/identity"),timer_1=require("../observable/timer"),innerFrom_1=require("../observable/innerFrom");function retry(r){var e=(r=(r=void 0===r?1/0:r)&&"object"==typeof r?r:{count:r}).count,s=void 0===e?1/0:e,a=r.delay,e=r.resetOnSuccess,t=void 0!==e&&e;return s<=0?identity_1.identity:lift_1.operate(function(r,u){var o,b=0,c=function(){var n=!1;o=r.subscribe(OperatorSubscriber_1.createOperatorSubscriber(u,function(r){t&&(b=0),u.next(r)},void 0,function(r){var e,t,i;b++<s?(e=function(){o?(o.unsubscribe(),o=null,c()):n=!0},null!=a?(t="number"==typeof a?timer_1.timer(a):innerFrom_1.innerFrom(a(r,b)),i=OperatorSubscriber_1.createOperatorSubscriber(u,function(){i.unsubscribe(),e()},function(){u.complete()}),t.subscribe(i)):e()):u.error(r)})),n&&(o.unsubscribe(),o=null,c())};c()})}exports.retry=retry;