Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowTime=void 0;var Subject_1=require("../Subject"),async_1=require("../scheduler/async"),Subscription_1=require("../Subscription"),lift_1=require("../util/lift"),OperatorSubscriber_1=require("./OperatorSubscriber"),arrRemove_1=require("../util/arrRemove"),args_1=require("../util/args"),executeSchedule_1=require("../util/executeSchedule");function windowTime(l){for(var e,r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];var a=null!=(e=args_1.popScheduler(r))?e:async_1.asyncScheduler,b=null!=(e=r[0])?e:null,d=r[1]||1/0;return lift_1.operate(function(e,n){function u(r){s(function(e){e=e.window;return r(e)}),r(n),n.unsubscribe()}var t=[],i=!1,c=function(e){var r=e.window,u=e.subs;r.complete(),u.unsubscribe(),arrRemove_1.arrRemove(t,e),i&&o()},o=function(){var e,r,u;t&&(e=new Subscription_1.Subscription,n.add(e),r=new Subject_1.Subject,t.push(u={window:r,subs:e,seen:0}),n.next(r.asObservable()),executeSchedule_1.executeSchedule(e,a,function(){return c(u)},l))},s=(null!==b&&0<=b?executeSchedule_1.executeSchedule(n,a,o,b,!0):i=!0,o(),function(e){return t.slice().forEach(e)});return e.subscribe(OperatorSubscriber_1.createOperatorSubscriber(n,function(r){s(function(e){e.window.next(r),d<=++e.seen&&c(e)})},function(){return u(function(e){return e.complete()})},function(r){return u(function(e){return e.error(r)})})),function(){t=null}})}exports.windowTime=windowTime;