import{Observable}from"./Observable";import{Subscription,EMPTY_SUBSCRIPTION}from"./Subscription";import{ObjectUnsubscribedError}from"./util/ObjectUnsubscribedError";import{arrRemove}from"./util/arrRemove";import{errorContext}from"./util/errorContext";class Subject extends Observable{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(r){var e=new AnonymousSubject(this,this);return e.operator=r,e}_throwIfClosed(){if(this.closed)throw new ObjectUnsubscribedError}next(e){errorContext(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(var r of this.currentObservers)r.next(e)}})}error(e){errorContext(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;for(var r=this.observers;r.length;)r.shift().error(e)}})}complete(){errorContext(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;for(var r=this.observers;r.length;)r.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){return 0<this.observers?.length}_trySubscribe(r){return this._throwIfClosed(),super._trySubscribe(r)}_subscribe(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)}_innerSubscribe(r){let{hasError:e,isStopped:s,observers:t}=this;return e||s?EMPTY_SUBSCRIPTION:(this.currentObservers=null,t.push(r),new Subscription(()=>{this.currentObservers=null,arrRemove(t,r)}))}_checkFinalizedStatuses(r){var{hasError:e,thrownError:s,isStopped:t}=this;e?r.error(s):t&&r.complete()}asObservable(){var r=new Observable;return r.source=this,r}}Subject.create=(r,e)=>new AnonymousSubject(r,e);class AnonymousSubject extends Subject{constructor(r,e){super(),this.destination=r,this.source=e}next(r){this.destination?.next?.(r)}error(r){this.destination?.error?.(r)}complete(){this.destination?.complete?.()}_subscribe(r){return this.source?.subscribe(r)??EMPTY_SUBSCRIPTION}}export{Subject,AnonymousSubject};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9TdWJqZWN0LnRzIl0sIm5hbWVzIjpbIk9ic2VydmFibGUiLCJTdWJzY3JpcHRpb24iLCJFTVBUWV9TVUJTQ1JJUFRJT04iLCJPYmplY3RVbnN1YnNjcmliZWRFcnJvciIsImFyclJlbW92ZSIsImVycm9yQ29udGV4dCIsIlN1YmplY3QiLCJjb25zdHJ1Y3RvciIsInN1cGVyIiwidGhpcyIsImNsb3NlZCIsImN1cnJlbnRPYnNlcnZlcnMiLCJvYnNlcnZlcnMiLCJpc1N0b3BwZWQiLCJoYXNFcnJvciIsInRocm93bkVycm9yIiwibGlmdCIsIm9wZXJhdG9yIiwic3ViamVjdCIsIkFub255bW91c1N1YmplY3QiLCJfdGhyb3dJZkNsb3NlZCIsIm5leHQiLCJ2YWx1ZSIsIkFycmF5IiwiZnJvbSIsIm9ic2VydmVyIiwiZXJyb3IiLCJlcnIiLCJsZW5ndGgiLCJzaGlmdCIsImNvbXBsZXRlIiwidW5zdWJzY3JpYmUiLCJvYnNlcnZlZCIsIl90cnlTdWJzY3JpYmUiLCJzdWJzY3JpYmVyIiwiX3N1YnNjcmliZSIsIl9jaGVja0ZpbmFsaXplZFN0YXR1c2VzIiwiX2lubmVyU3Vic2NyaWJlIiwicHVzaCIsImFzT2JzZXJ2YWJsZSIsIm9ic2VydmFibGUiLCJzb3VyY2UiLCJjcmVhdGUiLCJkZXN0aW5hdGlvbiIsInN1YnNjcmliZSJdLCJtYXBwaW5ncyI6Ik9BQ1NBLFVBQWdDLEtBQWQsc0JBRWxCQyxhQUFjQyxrQkFBMEMsS0FBaEIsd0JBRXhDQyx1QkFBK0QsS0FBaEMsd0NBQy9CQyxTQUFtQyxLQUFsQiwwQkFDakJDLFlBQXlDLEtBQXJCLDRCQVNoQkMsZ0JBQW1CTixXQXVCOUJPLGNBRUVDLE1BQUssRUF4QlBDLEtBQUFDLE9BQVMsQ0FBQSxFQUVERCxLQUFBRSxpQkFBeUMsS0FHakRGLEtBQUFHLFVBQTJCLEdBRTNCSCxLQUFBSSxVQUFZLENBQUEsRUFFWkosS0FBQUssU0FBVyxDQUFBLEVBRVhMLEtB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VVYsQ0FBVSxHQUFLaEMsa0JBQy9DLEMsUUF2S1dJLFFBOElBYSxnQiIsImZpbGUiOiJub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvU3ViamVjdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9wZXJhdG9yIH0gZnJvbSAnLi9PcGVyYXRvcic7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuL1N1YnNjcmliZXInO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uLCBFTVBUWV9TVUJTQ1JJUFRJT04gfSBmcm9tICcuL1N1YnNjcmlwdGlvbic7XG5pbXBvcnQgeyBPYnNlcnZlciwgU3Vic2NyaXB0aW9uTGlrZSwgVGVhcmRvd25Mb2dpYyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IgfSBmcm9tICcuL3V0aWwvT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3InO1xuaW1wb3J0IHsgYXJyUmVtb3ZlIH0gZnJvbSAnLi91dGlsL2FyclJlbW92ZSc7XG5pbXBvcnQgeyBlcnJvckNvbnRleHQgfSBmcm9tICcuL3V0aWwvZXJyb3JDb250ZXh0JztcblxuLyoqXG4gKiBBIFN1YmplY3QgaXMgYSBzcGVjaWFsIHR5cGUgb2YgT2JzZXJ2YWJsZSB0aGF0IGFsbG93cyB2YWx1ZXMgdG8gYmVcbiAqIG11bHRpY2FzdGVkIHRvIG1hbnkgT2JzZXJ2ZXJzLiBTdWJqZWN0cyBhcmUgbGlrZSBFdmVudEVtaXR0ZXJzLlxuICpcbiAqIEV2ZXJ5IFN1YmplY3QgaXMgYW4gT2JzZXJ2YWJsZSBhbmQgYW4gT2JzZXJ2ZXIuIFlvdSBjYW4gc3Vic2NyaWJlIHRvIGFcbiAqIFN1YmplY3QsIGFuZCB5b3UgY2FuIGNhbGwgbmV4dCB0byBmZWVkIHZhbHVlcyBhcyB3ZWxsIGFzIGVycm9yIGFuZCBjb21wbGV0ZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFN1YmplY3Q8VD4gZXh0ZW5kcyBPYnNlcnZhYmxlPFQ+IGltcGxlbWVudHMgU3Vic2NyaXB0aW9uTGlrZSB7XG4gIGNsb3NlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgY3VycmVudE9ic2VydmVyczogT2JzZXJ2ZXI8VD5bXSB8IG51bGwgPSBudWxsO1xuXG4gIC8qKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC4gKi9cbiAgb2JzZXJ2ZXJzOiBPYnNlcnZlcjxUPltdID0gW107XG4gIC8qKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC4gKi9cbiAgaXNTdG9wcGVkID0gZmFsc2U7XG4gIC8qKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC4gKi9cbiAgaGFzRXJyb3IgPSBmYWxzZTtcbiAgLyoqIEBkZXByZWNhdGVkIEludGVybmFsIGltcGxlbWVudGF0aW9uIGRldGFpbCwgZG8gbm90IHVzZSBkaXJlY3RseS4gV2lsbCBiZSBtYWRlIGludGVybmFsIGluIHY4LiAqL1xuICB0aHJvd25FcnJvcjogYW55ID0gbnVsbDtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhIFwic3ViamVjdFwiIGJ5IGJhc2ljYWxseSBnbHVpbmcgYW4gb2JzZXJ2ZXIgdG8gYW4gb2JzZXJ2YWJsZS5cbiAgICpcbiAgICogQGRlcHJlY2F0ZWQgUmVjb21tZW5kZWQgeW91IGRvIG5vdCB1c2UuIFdpbGwgYmUgcmVtb3ZlZCBhdCBzb21lIHBvaW50IGluIHRoZSBmdXR1cmUuIFBsYW5zIGZvciByZXBsYWNlbWVudCBzdGlsbCB1bmRlciBkaXNjdXNzaW9uLlxuICAgKi9cbiAgc3RhdGljIGNyZWF0ZTogKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnkgPSA8VD4oZGVzdGluYXRpb246IE9ic2VydmVyPFQ+LCBzb3VyY2U6IE9ic2VydmFibGU8VD4pOiBBbm9ueW1vdXNTdWJqZWN0PFQ+ID0+IHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c1N1YmplY3Q8VD4oZGVzdGluYXRpb24sIHNvdXJjZSk7XG4gIH07XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gTk9URTogVGhpcyBtdXN0IGJlIGhlcmUgdG8gb2JzY3VyZSBPYnNlcnZhYmxlJ3MgY29uc3RydWN0b3IuXG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIC8qKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC4gKi9cbiAgbGlmdDxSPihvcGVyYXRvcjogT3BlcmF0b3I8VCwgUj4pOiBPYnNlcnZhYmxlPFI+IHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IEFub255bW91c1N1YmplY3QodGhpcywgdGhpcyk7XG4gICAgc3ViamVjdC5vcGVyYXRvciA9IG9wZXJhdG9yIGFzIGFueTtcbiAgICByZXR1cm4gc3ViamVjdCBhcyBhbnk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByb3RlY3RlZCBfdGhyb3dJZkNsb3NlZCgpIHtcbiAgICBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgIHRocm93IG5ldyBPYmplY3RVbnN1YnNjcmliZWRFcnJvcigpO1xuICAgIH1cbiAgfVxuXG4gIG5leHQodmFsdWU6IFQpIHtcbiAgICBlcnJvckNvbnRleHQoKCkgPT4ge1xuICAgICAgdGhpcy5fdGhyb3dJZkNsb3NlZCgpO1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICBpZiAoIXRoaXMuY3VycmVudE9ic2VydmVycykge1xuICAgICAgICAgIHRoaXMuY3VycmVudE9ic2VydmVycyA9IEFycmF5LmZyb20odGhpcy5vYnNlcnZlcnMpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgdGhpcy5jdXJyZW50T2JzZXJ2ZXJzKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGVycm9yKGVycjogYW55KSB7XG4gICAgZXJyb3JDb250ZXh0KCgpID0+IHtcbiAgICAgIHRoaXMuX3Rocm93SWZDbG9zZWQoKTtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50aHJvd25FcnJvciA9IGVycjtcbiAgICAgICAgY29uc3QgeyBvYnNlcnZlcnMgfSA9IHRoaXM7XG4gICAgICAgIHdoaWxlIChvYnNlcnZlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgb2JzZXJ2ZXJzLnNoaWZ0KCkhLmVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGNvbXBsZXRlKCkge1xuICAgIGVycm9yQ29udGV4dCgoKSA9PiB7XG4gICAgICB0aGlzLl90aHJvd0lmQ2xvc2VkKCk7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgY29uc3QgeyBvYnNlcnZlcnMgfSA9IHRoaXM7XG4gICAgICAgIHdoaWxlIChvYnNlcnZlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgb2JzZXJ2ZXJzLnNoaWZ0KCkhLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKCkge1xuICAgIHRoaXMuaXNTdG9wcGVkID0gdGhpcy5jbG9zZWQgPSB0cnVlO1xuICAgIHRoaXMub2JzZXJ2ZXJzID0gdGhpcy5jdXJyZW50T2JzZXJ2ZXJzID0gbnVsbCE7XG4gIH1cblxuICBnZXQgb2JzZXJ2ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzPy5sZW5ndGggPiAwO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgX3RyeVN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KTogVGVhcmRvd25Mb2dpYyB7XG4gICAgdGhpcy5fdGhyb3dJZkNsb3NlZCgpO1xuICAgIHJldHVybiBzdXBlci5fdHJ5U3Vic2NyaWJlKHN1YnNjcmliZXIpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgX3N1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KTogU3Vic2NyaXB0aW9uIHtcbiAgICB0aGlzLl90aHJvd0lmQ2xvc2VkKCk7XG4gICAgdGhpcy5fY2hlY2tGaW5hbGl6ZWRTdGF0dXNlcyhzdWJzY3JpYmVyKTtcbiAgICByZXR1cm4gdGhpcy5faW5uZXJTdWJzY3JpYmUoc3Vic2NyaWJlcik7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByb3RlY3RlZCBfaW5uZXJTdWJzY3JpYmUoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxhbnk+KSB7XG4gICAgY29uc3QgeyBoYXNFcnJvciwgaXNTdG9wcGVkLCBvYnNlcnZlcnMgfSA9IHRoaXM7XG4gICAgaWYgKGhhc0Vycm9yIHx8IGlzU3RvcHBlZCkge1xuICAgICAgcmV0dXJuIEVNUFRZX1NVQlNDUklQVElPTjtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50T2JzZXJ2ZXJzID0gbnVsbDtcbiAgICBvYnNlcnZlcnMucHVzaChzdWJzY3JpYmVyKTtcbiAgICByZXR1cm4gbmV3IFN1YnNjcmlwdGlvbigoKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRPYnNlcnZlcnMgPSBudWxsO1xuICAgICAgYXJyUmVtb3ZlKG9ic2VydmVycywgc3Vic2NyaWJlcik7XG4gICAgfSk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHByb3RlY3RlZCBfY2hlY2tGaW5hbGl6ZWRTdGF0dXNlcyhzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPGFueT4pIHtcbiAgICBjb25zdCB7IGhhc0Vycm9yLCB0aHJvd25FcnJvciwgaXNTdG9wcGVkIH0gPSB0aGlzO1xuICAgIGlmIChoYXNFcnJvcikge1xuICAgICAgc3Vic2NyaWJlci5lcnJvcih0aHJvd25FcnJvcik7XG4gICAgfSBlbHNlIGlmIChpc1N0b3BwZWQpIHtcbiAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIHdpdGggdGhpcyBTdWJqZWN0IGFzIHRoZSBzb3VyY2UuIFlvdSBjYW4gZG8gdGhpc1xuICAgKiB0byBjcmVhdGUgY3VzdG9tIE9ic2VydmVyLXNpZGUgbG9naWMgb2YgdGhlIFN1YmplY3QgYW5kIGNvbmNlYWwgaXQgZnJvbVxuICAgKiBjb2RlIHRoYXQgdXNlcyB0aGUgT2JzZXJ2YWJsZS5cbiAgICogQHJldHVybiBPYnNlcnZhYmxlIHRoYXQgdGhpcyBTdWJqZWN0IGNhc3RzIHRvLlxuICAgKi9cbiAgYXNPYnNlcnZhYmxlKCk6IE9ic2VydmFibGU8VD4ge1xuICAgIGNvbnN0IG9ic2VydmFibGU6IGFueSA9IG5ldyBPYnNlcnZhYmxlPFQ+KCk7XG4gICAgb2JzZXJ2YWJsZS5zb3VyY2UgPSB0aGlzO1xuICAgIHJldHVybiBvYnNlcnZhYmxlO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBbm9ueW1vdXNTdWJqZWN0PFQ+IGV4dGVuZHMgU3ViamVjdDxUPiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC4gKi9cbiAgICBwdWJsaWMgZGVzdGluYXRpb24/OiBPYnNlcnZlcjxUPixcbiAgICBzb3VyY2U/OiBPYnNlcnZhYmxlPFQ+XG4gICkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gIH1cblxuICBuZXh0KHZhbHVlOiBUKSB7XG4gICAgdGhpcy5kZXN0aW5hdGlvbj8ubmV4dD8uKHZhbHVlKTtcbiAgfVxuXG4gIGVycm9yKGVycjogYW55KSB7XG4gICAgdGhpcy5kZXN0aW5hdGlvbj8uZXJyb3I/LihlcnIpO1xuICB9XG5cbiAgY29tcGxldGUoKSB7XG4gICAgdGhpcy5kZXN0aW5hdGlvbj8uY29tcGxldGU/LigpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgX3N1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KTogU3Vic2NyaXB0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5zb3VyY2U/LnN1YnNjcmliZShzdWJzY3JpYmVyKSA/PyBFTVBUWV9TVUJTQ1JJUFRJT047XG4gIH1cbn1cbiJdfQ==
