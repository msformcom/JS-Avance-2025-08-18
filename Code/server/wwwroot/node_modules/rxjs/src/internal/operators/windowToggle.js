import{Subject}from"../Subject";import{Subscription}from"../Subscription";import{operate}from"../util/lift";import{innerFrom}from"../observable/innerFrom";import{createOperatorSubscriber}from"./OperatorSubscriber";import{noop}from"../util/noop";import{arrRemove}from"../util/arrRemove";function windowToggle(e,c){return operate((r,i)=>{let b=[],n=r=>{for(;0<b.length;)b.shift().error(r);i.error(r)};innerFrom(e).subscribe(createOperatorSubscriber(i,r=>{let e=new Subject,o=(b.push(e),new Subscription);let t;try{t=innerFrom(c(r))}catch(r){return void n(r)}i.next(e.asObservable()),o.add(t.subscribe(createOperatorSubscriber(i,()=>{arrRemove(b,e),e.complete(),o.unsubscribe()},noop,n)))},noop)),r.subscribe(createOperatorSubscriber(i,r=>{var e;for(e of b.slice())e.next(r)},()=>{for(;0<b.length;)b.shift().complete();i.complete()},n,()=>{for(;0<b.length;)b.shift().unsubscribe()}))})}export{windowToggle};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vcGVyYXRvcnMvd2luZG93VG9nZ2xlLnRzIl0sIm5hbWVzIjpbIlN1YmplY3QiLCJTdWJzY3JpcHRpb24iLCJvcGVyYXRlIiwiaW5uZXJGcm9tIiwiY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyIiwibm9vcCIsImFyclJlbW92ZSIsIndpbmRvd1RvZ2dsZSIsIm9wZW5pbmdzIiwiY2xvc2luZ1NlbGVjdG9yIiwic291cmNlIiwic3Vic2NyaWJlciIsIndpbmRvd3MiLCJoYW5kbGVFcnJvciIsImxlbmd0aCIsInNoaWZ0IiwiZXJyb3IiLCJlcnIiLCJzdWJzY3JpYmUiLCJ3aW5kb3ciLCJjbG9zaW5nU3Vic2NyaXB0aW9uIiwicHVzaCIsImxldCIsImNsb3NpbmdOb3RpZmllciIsIm9wZW5WYWx1ZSIsIm5leHQiLCJhc09ic2VydmFibGUiLCJhZGQiLCJjb21wbGV0ZSIsInVuc3Vic2NyaWJlIiwic2xpY2UiLCJ2YWx1ZSJdLCJtYXBwaW5ncyI6Ik9BQ1NBLE9BQTJCLEtBQVosb0JBQ2ZDLFlBQXFDLEtBQWpCLHlCQUVwQkMsT0FBNkIsS0FBZCxzQkFDZkMsU0FBMEMsS0FBekIsaUNBQ2pCQyx3QkFBc0QsS0FBdEIsOEJBQ2hDQyxJQUEwQixLQUFkLHNCQUNaQyxTQUFvQyxLQUFuQixvQkErQ3BCLFNBQVVDLGFBQ2RDLEVBQ0FDLEdBRUEsT0FBT1AsUUFBUSxDQUFDUSxFQUFRQyxLQUN0QixJQUFNQyxFQUF3QixHQUV4QkMsRUFBYyxJQUNsQixLQUFPLEVBQUlELEVBQVFFLFFBQ2pCRixFQUFRRyxNQUFLLEVBQUlDLE1BQU1DLENBQUcsRUFFNUJOLEVBQVdLLE1BQU1DLENBQUcsQ0FDdEIsRUFFQWQsVUFBVUssQ0FBUSxFQUFFVSxVQUNsQmQseUJBQ0VPLEVBQ0EsSUFDRSxJQUFNUSxFQUFTLElBQUluQixRQUVib0IsR0FETlIsRUFBUVMsS0FBS0YsQ0FBTSxFQUNTLElBQUlsQixjQU9oQ3FCLElBQUlDLEVBQ0osSUFDRUEsRUFBa0JwQixVQUFVTSxFQUFnQmUsQ0FBUyxDQUFDLENBSXhELENBSEUsTUFBT1AsR0FFUCxPQURBSixLQUFBQSxFQUFZSSxDQUFHLENBRWpCLENBRUFOLEVBQVdjLEtBQUtOLEVBQU9PLGFBQVksQ0FBRSxFQUVyQ04sRUFBb0JPLElBQUlKLEVBQWdCTCxVQUFVZCx5QkFBeUJPLEVBaEJ2RCxLQUNsQkwsVUFBVU0sRUFBU08sQ0FBTSxFQUN6QkEsRUFBT1MsU0FBUSxFQUNmUixFQUFvQlMsWUFBVyxDQUNqQyxFQVlvR3hCLEtBQU1RLENBQVcsQ0FBQyxDQUFDLENBQ3pILEVBQ0FSLElBQUksQ0FDTCxFQUlISyxFQUFPUSxVQUNMZCx5QkFDRU8sRUFDQSxJQUdFLElBQ1dRLEVBQVgsSUFBV0EsS0FEU1AsRUFBUWtCLE1BQUssRUFFL0JYLEVBQU9NLEtBQUtNLENBQUssQ0FFckIsRUFDQSxLQUVFLEtBQU8sRUFBSW5CLEVBQVFFLFFBQ2pCRixFQUFRRyxNQUFLLEVBQUlhLFNBQVEsRUFFM0JqQixFQUFXaUIsU0FBUSxDQUNyQixFQUNBZixFQUNBLEtBTUUsS0FBTyxFQUFJRCxFQUFRRSxRQUNqQkYsRUFBUUcsTUFBSyxFQUFJYyxZQUFXLENBRWhDLENBQUMsQ0FDRixDQUVMLENBQUMsQ0FDSCxRQTVFZ0J0QixZQTRFaEIiLCJmaWxlIjoibm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL29wZXJhdG9ycy93aW5kb3dUb2dnbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAnLi4vU3ViamVjdCc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICcuLi9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZUlucHV0LCBPcGVyYXRvckZ1bmN0aW9uIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgb3BlcmF0ZSB9IGZyb20gJy4uL3V0aWwvbGlmdCc7XG5pbXBvcnQgeyBpbm5lckZyb20gfSBmcm9tICcuLi9vYnNlcnZhYmxlL2lubmVyRnJvbSc7XG5pbXBvcnQgeyBjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIgfSBmcm9tICcuL09wZXJhdG9yU3Vic2NyaWJlcic7XG5pbXBvcnQgeyBub29wIH0gZnJvbSAnLi4vdXRpbC9ub29wJztcbmltcG9ydCB7IGFyclJlbW92ZSB9IGZyb20gJy4uL3V0aWwvYXJyUmVtb3ZlJztcblxuLyoqXG4gKiBCcmFuY2ggb3V0IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSB2YWx1ZXMgYXMgYSBuZXN0ZWQgT2JzZXJ2YWJsZSBzdGFydGluZyBmcm9tXG4gKiBhbiBlbWlzc2lvbiBmcm9tIGBvcGVuaW5nc2AgYW5kIGVuZGluZyB3aGVuIHRoZSBvdXRwdXQgb2YgYGNsb3NpbmdTZWxlY3RvcmBcbiAqIGVtaXRzLlxuICpcbiAqIDxzcGFuIGNsYXNzPVwiaW5mb3JtYWxcIj5JdCdzIGxpa2Uge0BsaW5rIGJ1ZmZlclRvZ2dsZX0sIGJ1dCBlbWl0cyBhIG5lc3RlZFxuICogT2JzZXJ2YWJsZSBpbnN0ZWFkIG9mIGFuIGFycmF5Ljwvc3Bhbj5cbiAqXG4gKiAhW10od2luZG93VG9nZ2xlLnBuZylcbiAqXG4gKiBSZXR1cm5zIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyB3aW5kb3dzIG9mIGl0ZW1zIGl0IGNvbGxlY3RzIGZyb20gdGhlIHNvdXJjZVxuICogT2JzZXJ2YWJsZS4gVGhlIG91dHB1dCBPYnNlcnZhYmxlIGVtaXRzIHdpbmRvd3MgdGhhdCBjb250YWluIHRob3NlIGl0ZW1zXG4gKiBlbWl0dGVkIGJ5IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSBiZXR3ZWVuIHRoZSB0aW1lIHdoZW4gdGhlIGBvcGVuaW5nc2BcbiAqIE9ic2VydmFibGUgZW1pdHMgYW4gaXRlbSBhbmQgd2hlbiB0aGUgT2JzZXJ2YWJsZSByZXR1cm5lZCBieVxuICogYGNsb3NpbmdTZWxlY3RvcmAgZW1pdHMgYW4gaXRlbS5cbiAqXG4gKiAjIyBFeGFtcGxlXG4gKlxuICogRXZlcnkgb3RoZXIgc2Vjb25kLCBlbWl0IHRoZSBjbGljayBldmVudHMgZnJvbSB0aGUgbmV4dCA1MDBtc1xuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmcm9tRXZlbnQsIGludGVydmFsLCB3aW5kb3dUb2dnbGUsIEVNUFRZLCBtZXJnZUFsbCB9IGZyb20gJ3J4anMnO1xuICpcbiAqIGNvbnN0IGNsaWNrcyA9IGZyb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJyk7XG4gKiBjb25zdCBvcGVuaW5ncyA9IGludGVydmFsKDEwMDApO1xuICogY29uc3QgcmVzdWx0ID0gY2xpY2tzLnBpcGUoXG4gKiAgIHdpbmRvd1RvZ2dsZShvcGVuaW5ncywgaSA9PiBpICUgMiA/IGludGVydmFsKDUwMCkgOiBFTVBUWSksXG4gKiAgIG1lcmdlQWxsKClcbiAqICk7XG4gKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpO1xuICogYGBgXG4gKlxuICogQHNlZSB7QGxpbmsgd2luZG93fVxuICogQHNlZSB7QGxpbmsgd2luZG93Q291bnR9XG4gKiBAc2VlIHtAbGluayB3aW5kb3dUaW1lfVxuICogQHNlZSB7QGxpbmsgd2luZG93V2hlbn1cbiAqIEBzZWUge0BsaW5rIGJ1ZmZlclRvZ2dsZX1cbiAqXG4gKiBAcGFyYW0gb3BlbmluZ3MgQW4gb2JzZXJ2YWJsZSBvZiBub3RpZmljYXRpb25zIHRvIHN0YXJ0IG5ldyB3aW5kb3dzLlxuICogQHBhcmFtIGNsb3NpbmdTZWxlY3RvciBBIGZ1bmN0aW9uIHRoYXQgdGFrZXMgdGhlIHZhbHVlIGVtaXR0ZWQgYnkgdGhlXG4gKiBgb3BlbmluZ3NgIG9ic2VydmFibGUgYW5kIHJldHVybnMgYW4gT2JzZXJ2YWJsZSwgd2hpY2gsIHdoZW4gaXQgZW1pdHMgYSBuZXh0XG4gKiBub3RpZmljYXRpb24sIHNpZ25hbHMgdGhhdCB0aGUgYXNzb2NpYXRlZCB3aW5kb3cgc2hvdWxkIGNvbXBsZXRlLlxuICogQHJldHVybiBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhbiBPYnNlcnZhYmxlIG9mIHdpbmRvd3MsIHdoaWNoIGluIHR1cm4gYXJlXG4gKiBPYnNlcnZhYmxlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpbmRvd1RvZ2dsZTxULCBPPihcbiAgb3BlbmluZ3M6IE9ic2VydmFibGVJbnB1dDxPPixcbiAgY2xvc2luZ1NlbGVjdG9yOiAob3BlblZhbHVlOiBPKSA9PiBPYnNlcnZhYmxlSW5wdXQ8YW55PlxuKTogT3BlcmF0b3JGdW5jdGlvbjxULCBPYnNlcnZhYmxlPFQ+PiB7XG4gIHJldHVybiBvcGVyYXRlKChzb3VyY2UsIHN1YnNjcmliZXIpID0+IHtcbiAgICBjb25zdCB3aW5kb3dzOiBTdWJqZWN0PFQ+W10gPSBbXTtcblxuICAgIGNvbnN0IGhhbmRsZUVycm9yID0gKGVycjogYW55KSA9PiB7XG4gICAgICB3aGlsZSAoMCA8IHdpbmRvd3MubGVuZ3RoKSB7XG4gICAgICAgIHdpbmRvd3Muc2hpZnQoKSEuZXJyb3IoZXJyKTtcbiAgICAgIH1cbiAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICB9O1xuXG4gICAgaW5uZXJGcm9tKG9wZW5pbmdzKS5zdWJzY3JpYmUoXG4gICAgICBjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoXG4gICAgICAgIHN1YnNjcmliZXIsXG4gICAgICAgIChvcGVuVmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCB3aW5kb3cgPSBuZXcgU3ViamVjdDxUPigpO1xuICAgICAgICAgIHdpbmRvd3MucHVzaCh3aW5kb3cpO1xuICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgY29uc3QgY2xvc2VXaW5kb3cgPSAoKSA9PiB7XG4gICAgICAgICAgICBhcnJSZW1vdmUod2luZG93cywgd2luZG93KTtcbiAgICAgICAgICAgIHdpbmRvdy5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgY2xvc2luZ1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBsZXQgY2xvc2luZ05vdGlmaWVyOiBPYnNlcnZhYmxlPGFueT47XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNsb3NpbmdOb3RpZmllciA9IGlubmVyRnJvbShjbG9zaW5nU2VsZWN0b3Iob3BlblZhbHVlKSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBoYW5kbGVFcnJvcihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHN1YnNjcmliZXIubmV4dCh3aW5kb3cuYXNPYnNlcnZhYmxlKCkpO1xuXG4gICAgICAgICAgY2xvc2luZ1N1YnNjcmlwdGlvbi5hZGQoY2xvc2luZ05vdGlmaWVyLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgY2xvc2VXaW5kb3csIG5vb3AsIGhhbmRsZUVycm9yKSkpO1xuICAgICAgICB9LFxuICAgICAgICBub29wXG4gICAgICApXG4gICAgKTtcblxuICAgIC8vIFN1YnNjcmliZSB0byB0aGUgc291cmNlIHRvIGdldCB0aGluZ3Mgc3RhcnRlZC5cbiAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKFxuICAgICAgICBzdWJzY3JpYmVyLFxuICAgICAgICAodmFsdWU6IFQpID0+IHtcbiAgICAgICAgICAvLyBDb3B5IHRoZSB3aW5kb3dzIGFycmF5IGJlZm9yZSB3ZSBlbWl0IHRvXG4gICAgICAgICAgLy8gbWFrZSBzdXJlIHdlIGRvbid0IGhhdmUgaXNzdWVzIHdpdGggcmVlbnRyYW50IGNvZGUuXG4gICAgICAgICAgY29uc3Qgd2luZG93c0NvcHkgPSB3aW5kb3dzLnNsaWNlKCk7XG4gICAgICAgICAgZm9yIChjb25zdCB3aW5kb3cgb2Ygd2luZG93c0NvcHkpIHtcbiAgICAgICAgICAgIHdpbmRvdy5uZXh0KHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICAvLyBDb21wbGV0ZSBhbGwgb2Ygb3VyIHdpbmRvd3MgYmVmb3JlIHdlIGNvbXBsZXRlLlxuICAgICAgICAgIHdoaWxlICgwIDwgd2luZG93cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHdpbmRvd3Muc2hpZnQoKSEuY29tcGxldGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICB9LFxuICAgICAgICBoYW5kbGVFcnJvcixcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIC8vIEFkZCB0aGlzIGZpbmFsaXphdGlvbiBzbyB0aGF0IGFsbCB3aW5kb3cgc3ViamVjdHMgYXJlXG4gICAgICAgICAgLy8gZGlzcG9zZWQgb2YuIFRoaXMgd2F5LCBpZiBhIHVzZXIgdHJpZXMgdG8gc3Vic2NyaWJlXG4gICAgICAgICAgLy8gdG8gYSB3aW5kb3cgKmFmdGVyKiB0aGUgb3V0ZXIgc3Vic2NyaXB0aW9uIGhhcyBiZWVuIHVuc3Vic2NyaWJlZCxcbiAgICAgICAgICAvLyB0aGV5IHdpbGwgZ2V0IGFuIGVycm9yLCBpbnN0ZWFkIG9mIHdhaXRpbmcgZm9yZXZlciB0b1xuICAgICAgICAgIC8vIHNlZSBpZiBhIHZhbHVlIGFycml2ZXMuXG4gICAgICAgICAgd2hpbGUgKDAgPCB3aW5kb3dzLmxlbmd0aCkge1xuICAgICAgICAgICAgd2luZG93cy5zaGlmdCgpIS51bnN1YnNjcmliZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKVxuICAgICk7XG4gIH0pO1xufVxuIl19
