import{innerFrom}from"../observable/innerFrom";import{Subject}from"../Subject";import{operate}from"../util/lift";import{createOperatorSubscriber}from"./OperatorSubscriber";function repeatWhen(a){return operate((r,e)=>{let t,o=!1,b,i=!1,c=!1,n=()=>c&&i&&(e.complete(),!0),u=()=>(b||(b=new Subject,innerFrom(a(b)).subscribe(createOperatorSubscriber(e,()=>{t?p():o=!0},()=>{i=!0,n()}))),b),p=()=>{c=!1,t=r.subscribe(createOperatorSubscriber(e,void 0,()=>{c=!0,n()||u().next()})),o&&(t.unsubscribe(),t=null,o=!1,p())};p()})}export{repeatWhen};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vcGVyYXRvcnMvcmVwZWF0V2hlbi50cyJdLCJuYW1lcyI6WyJpbm5lckZyb20iLCJTdWJqZWN0Iiwib3BlcmF0ZSIsImNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlciIsInJlcGVhdFdoZW4iLCJub3RpZmllciIsInNvdXJjZSIsInN1YnNjcmliZXIiLCJsZXQiLCJpbm5lclN1YiIsInN5bmNSZXN1YiIsImNvbXBsZXRpb25zJCIsImlzTm90aWZpZXJDb21wbGV0ZSIsImlzTWFpbkNvbXBsZXRlIiwiY2hlY2tDb21wbGV0ZSIsImNvbXBsZXRlIiwiZ2V0Q29tcGxldGlvblN1YmplY3QiLCJzdWJzY3JpYmUiLCJzdWJzY3JpYmVGb3JSZXBlYXRXaGVuIiwidW5kZWZpbmVkIiwibmV4dCIsInVuc3Vic2NyaWJlIl0sIm1hcHBpbmdzIjoiT0FDU0EsU0FBMEMsS0FBekIsaUNBQ2pCQyxPQUEyQixLQUFaLG9CQUlmQyxPQUE2QixLQUFkLHNCQUNmQyx3QkFBc0QsS0FBdEIsdUJBb0NuQyxTQUFVQyxXQUFjQyxHQUM1QixPQUFPSCxRQUFRLENBQUNJLEVBQVFDLEtBQ3RCQyxJQUFJQyxFQUNBQyxFQUFZLENBQUEsRUFDWkMsRUFDQUMsRUFBcUIsQ0FBQSxFQUNyQkMsRUFBaUIsQ0FBQSxFQUtmQyxFQUFnQixJQUFNRCxHQUFrQkQsSUFBdUJMLEVBQVdRLFNBQVEsRUFBSSxDQUFBLEdBS3RGQyxFQUF1QixLQUN0QkwsSUFDSEEsRUFBZSxJQUFJVixRQUluQkQsVUFBVUssRUFBU00sQ0FBWSxDQUFDLEVBQUVNLFVBQ2hDZCx5QkFDRUksRUFDQSxLQUNNRSxFQUNGUyxFQUFzQixFQU10QlIsRUFBWSxDQUFBLENBRWhCLEVBQ0EsS0FDRUUsRUFBcUIsQ0FBQSxFQUNyQkUsRUFBYSxDQUNmLENBQUMsQ0FDRixHQUdFSCxHQUdITyxFQUF5QixLQUM3QkwsRUFBaUIsQ0FBQSxFQUVqQkosRUFBV0gsRUFBT1csVUFDaEJkLHlCQUF5QkksRUFBWVksS0FBQUEsRUFBVyxLQUM5Q04sRUFBaUIsQ0FBQSxFQU1oQkMsRUFBYSxHQUFNRSxFQUFvQixFQUFHSSxLQUFJLENBQ2pELENBQUMsQ0FBQyxFQUdBVixJQUtGRCxFQUFTWSxZQUFXLEVBSXBCWixFQUFXLEtBRVhDLEVBQVksQ0FBQSxFQUVaUSxFQUFzQixFQUUxQixFQUdBQSxFQUFzQixDQUN4QixDQUFDLENBQ0gsUUFqRmdCZCxVQWlGaEIiLCJmaWxlIjoibm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL29wZXJhdG9ycy9yZXBlYXRXaGVuLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgaW5uZXJGcm9tIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9pbm5lckZyb20nO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJy4uL1N1YmplY3QnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcblxuaW1wb3J0IHsgTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uLCBPYnNlcnZhYmxlSW5wdXQgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBvcGVyYXRlIH0gZnJvbSAnLi4vdXRpbC9saWZ0JztcbmltcG9ydCB7IGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlciB9IGZyb20gJy4vT3BlcmF0b3JTdWJzY3JpYmVyJztcblxuLyoqXG4gKiBSZXR1cm5zIGFuIE9ic2VydmFibGUgdGhhdCBtaXJyb3JzIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSB3aXRoIHRoZSBleGNlcHRpb24gb2YgYSBgY29tcGxldGVgLiBJZiB0aGUgc291cmNlXG4gKiBPYnNlcnZhYmxlIGNhbGxzIGBjb21wbGV0ZWAsIHRoaXMgbWV0aG9kIHdpbGwgZW1pdCB0byB0aGUgT2JzZXJ2YWJsZSByZXR1cm5lZCBmcm9tIGBub3RpZmllcmAuIElmIHRoYXQgT2JzZXJ2YWJsZVxuICogY2FsbHMgYGNvbXBsZXRlYCBvciBgZXJyb3JgLCB0aGVuIHRoaXMgbWV0aG9kIHdpbGwgY2FsbCBgY29tcGxldGVgIG9yIGBlcnJvcmAgb24gdGhlIGNoaWxkIHN1YnNjcmlwdGlvbi4gT3RoZXJ3aXNlXG4gKiB0aGlzIG1ldGhvZCB3aWxsIHJlc3Vic2NyaWJlIHRvIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZS5cbiAqXG4gKiAhW10ocmVwZWF0V2hlbi5wbmcpXG4gKlxuICogIyMgRXhhbXBsZVxuICpcbiAqIFJlcGVhdCBhIG1lc3NhZ2Ugc3RyZWFtIG9uIGNsaWNrXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IG9mLCBmcm9tRXZlbnQsIHJlcGVhdFdoZW4gfSBmcm9tICdyeGpzJztcbiAqXG4gKiBjb25zdCBzb3VyY2UgPSBvZignUmVwZWF0IG1lc3NhZ2UnKTtcbiAqIGNvbnN0IGRvY3VtZW50Q2xpY2skID0gZnJvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snKTtcbiAqXG4gKiBjb25zdCByZXN1bHQgPSBzb3VyY2UucGlwZShyZXBlYXRXaGVuKCgpID0+IGRvY3VtZW50Q2xpY2skKSk7XG4gKlxuICogcmVzdWx0LnN1YnNjcmliZShkYXRhID0+IGNvbnNvbGUubG9nKGRhdGEpKVxuICogYGBgXG4gKlxuICogQHNlZSB7QGxpbmsgcmVwZWF0fVxuICogQHNlZSB7QGxpbmsgcmV0cnl9XG4gKiBAc2VlIHtAbGluayByZXRyeVdoZW59XG4gKlxuICogQHBhcmFtIG5vdGlmaWVyIEZ1bmN0aW9uIHRoYXQgcmVjZWl2ZXMgYW4gT2JzZXJ2YWJsZSBvZiBub3RpZmljYXRpb25zIHdpdGhcbiAqIHdoaWNoIGEgdXNlciBjYW4gYGNvbXBsZXRlYCBvciBgZXJyb3JgLCBhYm9ydGluZyB0aGUgcmVwZXRpdGlvbi5cbiAqIEByZXR1cm4gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gT2JzZXJ2YWJsZSB0aGF0IG1pcnJvcnMgdGhlIHNvdXJjZVxuICogT2JzZXJ2YWJsZSB3aXRoIHRoZSBleGNlcHRpb24gb2YgYSBgY29tcGxldGVgLlxuICogQGRlcHJlY2F0ZWQgV2lsbCBiZSByZW1vdmVkIGluIHY5IG9yIHYxMC4gVXNlIHtAbGluayByZXBlYXR9J3Mge0BsaW5rIFJlcGVhdENvbmZpZyNkZWxheSBkZWxheX0gb3B0aW9uIGluc3RlYWQuXG4gKiBJbnN0ZWFkIG9mIGByZXBlYXRXaGVuKCgpID0+IG5vdGlmeSQpYCwgdXNlOiBgcmVwZWF0KHsgZGVsYXk6ICgpID0+IG5vdGlmeSQgfSlgLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVwZWF0V2hlbjxUPihub3RpZmllcjogKG5vdGlmaWNhdGlvbnM6IE9ic2VydmFibGU8dm9pZD4pID0+IE9ic2VydmFibGVJbnB1dDxhbnk+KTogTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uPFQ+IHtcbiAgcmV0dXJuIG9wZXJhdGUoKHNvdXJjZSwgc3Vic2NyaWJlcikgPT4ge1xuICAgIGxldCBpbm5lclN1YjogU3Vic2NyaXB0aW9uIHwgbnVsbDtcbiAgICBsZXQgc3luY1Jlc3ViID0gZmFsc2U7XG4gICAgbGV0IGNvbXBsZXRpb25zJDogU3ViamVjdDx2b2lkPjtcbiAgICBsZXQgaXNOb3RpZmllckNvbXBsZXRlID0gZmFsc2U7XG4gICAgbGV0IGlzTWFpbkNvbXBsZXRlID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdG8gc2VlIGlmIHdlIGNhbiBjb21wbGV0ZSB0aGUgcmVzdWx0LCBjb21wbGV0ZXMgaXQsIGFuZCByZXR1cm5zIGB0cnVlYCBpZiBpdCB3YXMgY29tcGxldGVkLlxuICAgICAqL1xuICAgIGNvbnN0IGNoZWNrQ29tcGxldGUgPSAoKSA9PiBpc01haW5Db21wbGV0ZSAmJiBpc05vdGlmaWVyQ29tcGxldGUgJiYgKHN1YnNjcmliZXIuY29tcGxldGUoKSwgdHJ1ZSk7XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3ViamVjdCB0byBzZW5kIGVycm9ycyB0aHJvdWdoLiBJZiBpdCBkb2Vzbid0IGV4aXN0LFxuICAgICAqIHdlIGtub3cgd2UgbmVlZCB0byBzZXR1cCB0aGUgbm90aWZpZXIuXG4gICAgICovXG4gICAgY29uc3QgZ2V0Q29tcGxldGlvblN1YmplY3QgPSAoKSA9PiB7XG4gICAgICBpZiAoIWNvbXBsZXRpb25zJCkge1xuICAgICAgICBjb21wbGV0aW9ucyQgPSBuZXcgU3ViamVjdCgpO1xuXG4gICAgICAgIC8vIElmIHRoZSBjYWxsIHRvIGBub3RpZmllcmAgdGhyb3dzLCBpdCB3aWxsIGJlIGNhdWdodCBieSB0aGUgT3BlcmF0b3JTdWJzY3JpYmVyXG4gICAgICAgIC8vIEluIHRoZSBtYWluIHN1YnNjcmlwdGlvbiAtLSBpbiBgc3Vic2NyaWJlRm9yUmVwZWF0V2hlbmAuXG4gICAgICAgIGlubmVyRnJvbShub3RpZmllcihjb21wbGV0aW9ucyQpKS5zdWJzY3JpYmUoXG4gICAgICAgICAgY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKFxuICAgICAgICAgICAgc3Vic2NyaWJlcixcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGlubmVyU3ViKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlRm9yUmVwZWF0V2hlbigpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYW4gaW5uZXJTdWIgeWV0LCB0aGF0J3MgYmVjYXVzZSB0aGUgaW5uZXIgc3Vic2NyaXB0aW9uXG4gICAgICAgICAgICAgICAgLy8gY2FsbCBoYXNuJ3QgZXZlbiByZXR1cm5lZCB5ZXQuIFdlJ3ZlIGFycml2ZWQgaGVyZSBzeW5jaHJvbm91c2x5LlxuICAgICAgICAgICAgICAgIC8vIFNvIHdlIGZsYWcgdGhhdCB3ZSB3YW50IHRvIHJlc3ViLCBzdWNoIHRoYXQgd2UgY2FuIGVuc3VyZSBmaW5hbGl6YXRpb25cbiAgICAgICAgICAgICAgICAvLyBoYXBwZW5zIGJlZm9yZSB3ZSByZXN1YnNjcmliZS5cbiAgICAgICAgICAgICAgICBzeW5jUmVzdWIgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICBpc05vdGlmaWVyQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgICBjaGVja0NvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbXBsZXRpb25zJDtcbiAgICB9O1xuXG4gICAgY29uc3Qgc3Vic2NyaWJlRm9yUmVwZWF0V2hlbiA9ICgpID0+IHtcbiAgICAgIGlzTWFpbkNvbXBsZXRlID0gZmFsc2U7XG5cbiAgICAgIGlubmVyU3ViID0gc291cmNlLnN1YnNjcmliZShcbiAgICAgICAgY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKHN1YnNjcmliZXIsIHVuZGVmaW5lZCwgKCkgPT4ge1xuICAgICAgICAgIGlzTWFpbkNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgd2UgYXJlIGNvbXBsZXRlLCBhbmQgY29tcGxldGUgaWYgc28uXG4gICAgICAgICAgLy8gSWYgd2UgYXJlIG5vdCBjb21wbGV0ZS4gR2V0IHRoZSBzdWJqZWN0LiBUaGlzIGNhbGxzIHRoZSBgbm90aWZpZXJgIGZ1bmN0aW9uLlxuICAgICAgICAgIC8vIElmIHRoYXQgZnVuY3Rpb24gZmFpbHMsIGl0IHdpbGwgdGhyb3cgYW5kIGAubmV4dCgpYCB3aWxsIG5vdCBiZSByZWFjaGVkIG9uIHRoaXNcbiAgICAgICAgICAvLyBsaW5lLiBUaGUgdGhyb3duIGVycm9yIGlzIGNhdWdodCBieSB0aGUgX2NvbXBsZXRlIGhhbmRsZXIgaW4gdGhpc1xuICAgICAgICAgIC8vIGBPcGVyYXRvclN1YnNjcmliZXJgIGFuZCBoYW5kbGVkIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgIWNoZWNrQ29tcGxldGUoKSAmJiBnZXRDb21wbGV0aW9uU3ViamVjdCgpLm5leHQoKTtcbiAgICAgICAgfSlcbiAgICAgICk7XG5cbiAgICAgIGlmIChzeW5jUmVzdWIpIHtcbiAgICAgICAgLy8gRW5zdXJlIHRoYXQgdGhlIGlubmVyIHN1YnNjcmlwdGlvbiBpcyB0b3JuIGRvd24gYmVmb3JlXG4gICAgICAgIC8vIG1vdmluZyBvbiB0byB0aGUgbmV4dCBzdWJzY3JpcHRpb24gaW4gdGhlIHN5bmNocm9ub3VzIGNhc2UuXG4gICAgICAgIC8vIElmIHdlIGRvbid0IGRvIHRoaXMgaGVyZSwgYWxsIGlubmVyIHN1YnNjcmlwdGlvbnMgd2lsbCBub3QgYmVcbiAgICAgICAgLy8gdG9ybiBkb3duIHVudGlsIHRoZSBlbnRpcmUgb2JzZXJ2YWJsZSBpcyBkb25lLlxuICAgICAgICBpbm5lclN1Yi51bnN1YnNjcmliZSgpO1xuICAgICAgICAvLyBJdCBpcyBpbXBvcnRhbnQgdG8gbnVsbCB0aGlzIG91dC4gTm90IG9ubHkgdG8gZnJlZSB1cCBtZW1vcnksIGJ1dFxuICAgICAgICAvLyB0byBtYWtlIHN1cmUgY29kZSBhYm92ZSBrbm93cyB3ZSBhcmUgaW4gYSBzdWJzY3JpYmluZyBzdGF0ZSB0b1xuICAgICAgICAvLyBoYW5kbGUgc3luY2hyb25vdXMgcmVzdWJzY3JpcHRpb24uXG4gICAgICAgIGlubmVyU3ViID0gbnVsbDtcbiAgICAgICAgLy8gV2UgbWF5IG5lZWQgdG8gZG8gdGhpcyBtdWx0aXBsZSB0aW1lcywgc28gcmVzZXQgdGhlIGZsYWdzLlxuICAgICAgICBzeW5jUmVzdWIgPSBmYWxzZTtcbiAgICAgICAgLy8gUmVzdWJzY3JpYmVcbiAgICAgICAgc3Vic2NyaWJlRm9yUmVwZWF0V2hlbigpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBTdGFydCB0aGUgc3Vic2NyaXB0aW9uXG4gICAgc3Vic2NyaWJlRm9yUmVwZWF0V2hlbigpO1xuICB9KTtcbn1cbiJdfQ==
