import{isFunction}from"../util/isFunction";import{operate}from"../util/lift";import{createOperatorSubscriber}from"./OperatorSubscriber";import{identity}from"../util/identity";function tap(r,e,t){let i=isFunction(r)||e||t?{next:r,error:e,complete:t}:r;return i?operate((r,e)=>{i.subscribe?.();let t=!0;r.subscribe(createOperatorSubscriber(e,r=>{i.next?.(r),e.next(r)},()=>{t=!1,i.complete?.(),e.complete()},r=>{t=!1,i.error?.(r),e.error(r)},()=>{t&&i.unsubscribe?.(),i.finalize?.()}))}):identity}export{tap};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vcGVyYXRvcnMvdGFwLnRzIl0sIm5hbWVzIjpbImlzRnVuY3Rpb24iLCJvcGVyYXRlIiwiY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyIiwiaWRlbnRpdHkiLCJ0YXAiLCJvYnNlcnZlck9yTmV4dCIsImVycm9yIiwiY29tcGxldGUiLCJ0YXBPYnNlcnZlciIsIm5leHQiLCJzb3VyY2UiLCJzdWJzY3JpYmVyIiwic3Vic2NyaWJlIiwibGV0IiwiaXNVbnN1YiIsInZhbHVlIiwiZXJyIiwidW5zdWJzY3JpYmUiLCJmaW5hbGl6ZSJdLCJtYXBwaW5ncyI6Ik9BQ1NBLFVBQXNDLEtBQXBCLDRCQUNsQkMsT0FBNkIsS0FBZCxzQkFDZkMsd0JBQXNELEtBQXRCLDhCQUNoQ0MsUUFBa0MsS0FBbEIsbUJBa0tuQixTQUFVQyxJQUNkQyxFQUNBQyxFQUNBQyxHQUtBLElBQU1DLEVBQ0pSLFdBQVdLLENBQWMsR0FBS0MsR0FBU0MsRUFFbEMsQ0FBRUUsS0FBTUosRUFBMkVDLE1BQUFBLEVBQU9DLFNBQUFBLENBQVEsRUFDbkdGLEVBRU4sT0FBT0csRUFDSFAsUUFBUSxDQUFDUyxFQUFRQyxLQUNmSCxFQUFZSSxZQUFXLEVBQ3ZCQyxJQUFJQyxFQUFVLENBQUEsRUFDZEosRUFBT0UsVUFDTFYseUJBQ0VTLEVBQ0EsSUFDRUgsRUFBWUMsT0FBT00sQ0FBSyxFQUN4QkosRUFBV0YsS0FBS00sQ0FBSyxDQUN2QixFQUNBLEtBQ0VELEVBQVUsQ0FBQSxFQUNWTixFQUFZRCxXQUFVLEVBQ3RCSSxFQUFXSixTQUFRLENBQ3JCLEVBQ0EsSUFDRU8sRUFBVSxDQUFBLEVBQ1ZOLEVBQVlGLFFBQVFVLENBQUcsRUFDdkJMLEVBQVdMLE1BQU1VLENBQUcsQ0FDdEIsRUFDQSxLQUNNRixHQUNGTixFQUFZUyxjQUFhLEVBRTNCVCxFQUFZVSxXQUFVLENBQ3hCLENBQUMsQ0FDRixDQUVMLENBQUMsRUFJRGYsUUFDTixRQWhEZ0JDLEdBZ0RoQiIsImZpbGUiOiJub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvb3BlcmF0b3JzL3RhcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1vbm9UeXBlT3BlcmF0b3JGdW5jdGlvbiwgT2JzZXJ2ZXIgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi4vdXRpbC9pc0Z1bmN0aW9uJztcbmltcG9ydCB7IG9wZXJhdGUgfSBmcm9tICcuLi91dGlsL2xpZnQnO1xuaW1wb3J0IHsgY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyIH0gZnJvbSAnLi9PcGVyYXRvclN1YnNjcmliZXInO1xuaW1wb3J0IHsgaWRlbnRpdHkgfSBmcm9tICcuLi91dGlsL2lkZW50aXR5JztcblxuLyoqXG4gKiBBbiBleHRlbnNpb24gdG8gdGhlIHtAbGluayBPYnNlcnZlcn0gaW50ZXJmYWNlIHVzZWQgb25seSBieSB0aGUge0BsaW5rIHRhcH0gb3BlcmF0b3IuXG4gKlxuICogSXQgcHJvdmlkZXMgYSB1c2VmdWwgc2V0IG9mIGNhbGxiYWNrcyBhIHVzZXIgY2FuIHJlZ2lzdGVyIHRvIGRvIHNpZGUtZWZmZWN0cyBpblxuICogY2FzZXMgb3RoZXIgdGhhbiB3aGF0IHRoZSB1c3VhbCB7QGxpbmsgT2JzZXJ2ZXJ9IGNhbGxiYWNrcyBhcmVcbiAqICh7QGxpbmsgZ3VpZGUvZ2xvc3NhcnktYW5kLXNlbWFudGljcyNuZXh0IG5leHR9LFxuICoge0BsaW5rIGd1aWRlL2dsb3NzYXJ5LWFuZC1zZW1hbnRpY3MjZXJyb3IgZXJyb3J9IGFuZC9vclxuICoge0BsaW5rIGd1aWRlL2dsb3NzYXJ5LWFuZC1zZW1hbnRpY3MjY29tcGxldGUgY29tcGxldGV9KS5cbiAqXG4gKiAjIyBFeGFtcGxlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGZyb21FdmVudCwgc3dpdGNoTWFwLCB0YXAsIGludGVydmFsLCB0YWtlIH0gZnJvbSAncnhqcyc7XG4gKlxuICogY29uc3Qgc291cmNlJCA9IGZyb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJyk7XG4gKiBjb25zdCByZXN1bHQkID0gc291cmNlJC5waXBlKFxuICogICBzd2l0Y2hNYXAoKF8sIGkpID0+IGkgJSAyID09PSAwXG4gKiAgICAgPyBmcm9tRXZlbnQoZG9jdW1lbnQsICdtb3VzZW1vdmUnKS5waXBlKFxuICogICAgICAgICB0YXAoe1xuICogICAgICAgICAgIHN1YnNjcmliZTogKCkgPT4gY29uc29sZS5sb2coJ1N1YnNjcmliZWQgdG8gdGhlIG1vdXNlIG1vdmUgZXZlbnRzIGFmdGVyIGNsaWNrICMnICsgaSksXG4gKiAgICAgICAgICAgdW5zdWJzY3JpYmU6ICgpID0+IGNvbnNvbGUubG9nKCdNb3VzZSBtb3ZlIGV2ZW50cyAjJyArIGkgKyAnIHVuc3Vic2NyaWJlZCcpLFxuICogICAgICAgICAgIGZpbmFsaXplOiAoKSA9PiBjb25zb2xlLmxvZygnTW91c2UgbW92ZSBldmVudHMgIycgKyBpICsgJyBmaW5hbGl6ZWQnKVxuICogICAgICAgICB9KVxuICogICAgICAgKVxuICogICAgIDogaW50ZXJ2YWwoMV8wMDApLnBpcGUoXG4gKiAgICAgICAgIHRha2UoNSksXG4gKiAgICAgICAgIHRhcCh7XG4gKiAgICAgICAgICAgc3Vic2NyaWJlOiAoKSA9PiBjb25zb2xlLmxvZygnU3Vic2NyaWJlZCB0byB0aGUgMS1zZWNvbmQgaW50ZXJ2YWwgZXZlbnRzIGFmdGVyIGNsaWNrICMnICsgaSksXG4gKiAgICAgICAgICAgdW5zdWJzY3JpYmU6ICgpID0+IGNvbnNvbGUubG9nKCcxLXNlY29uZCBpbnRlcnZhbCBldmVudHMgIycgKyBpICsgJyB1bnN1YnNjcmliZWQnKSxcbiAqICAgICAgICAgICBmaW5hbGl6ZTogKCkgPT4gY29uc29sZS5sb2coJzEtc2Vjb25kIGludGVydmFsIGV2ZW50cyAjJyArIGkgKyAnIGZpbmFsaXplZCcpXG4gKiAgICAgICAgIH0pXG4gKiAgICAgICApXG4gKiAgIClcbiAqICk7XG4gKlxuICogY29uc3Qgc3Vic2NyaXB0aW9uID0gcmVzdWx0JC5zdWJzY3JpYmUoe1xuICogICBuZXh0OiBjb25zb2xlLmxvZ1xuICogfSk7XG4gKlxuICogc2V0VGltZW91dCgoKSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKCdVbnN1YnNjcmliZSBhZnRlciA2MCBzZWNvbmRzJyk7XG4gKiAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICogfSwgNjBfMDAwKTtcbiAqIGBgYFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRhcE9ic2VydmVyPFQ+IGV4dGVuZHMgT2JzZXJ2ZXI8VD4ge1xuICAvKipcbiAgICogVGhlIGNhbGxiYWNrIHRoYXQgYHRhcGAgb3BlcmF0b3IgaW52b2tlcyBhdCB0aGUgbW9tZW50IHdoZW4gdGhlIHNvdXJjZSBPYnNlcnZhYmxlXG4gICAqIGdldHMgc3Vic2NyaWJlZCB0by5cbiAgICovXG4gIHN1YnNjcmliZTogKCkgPT4gdm9pZDtcbiAgLyoqXG4gICAqIFRoZSBjYWxsYmFjayB0aGF0IGB0YXBgIG9wZXJhdG9yIGludm9rZXMgd2hlbiBhbiBleHBsaWNpdFxuICAgKiB7QGxpbmsgZ3VpZGUvZ2xvc3NhcnktYW5kLXNlbWFudGljcyN1bnN1YnNjcmlwdGlvbiB1bnN1YnNjcmliZX0gaGFwcGVucy4gSXQgd29uJ3QgZ2V0IGludm9rZWQgb25cbiAgICogYGVycm9yYCBvciBgY29tcGxldGVgIGV2ZW50cy5cbiAgICovXG4gIHVuc3Vic2NyaWJlOiAoKSA9PiB2b2lkO1xuICAvKipcbiAgICogVGhlIGNhbGxiYWNrIHRoYXQgYHRhcGAgb3BlcmF0b3IgaW52b2tlcyB3aGVuIGFueSBraW5kIG9mXG4gICAqIHtAbGluayBndWlkZS9nbG9zc2FyeS1hbmQtc2VtYW50aWNzI2ZpbmFsaXphdGlvbiBmaW5hbGl6YXRpb259IGhhcHBlbnMgLSBlaXRoZXIgd2hlblxuICAgKiB0aGUgc291cmNlIE9ic2VydmFibGUgYGVycm9yYHMgb3IgYGNvbXBsZXRlYHMgb3Igd2hlbiBpdCBnZXRzIGV4cGxpY2l0bHkgdW5zdWJzY3JpYmVkXG4gICAqIGJ5IHRoZSB1c2VyLiBUaGVyZSBpcyBubyBkaWZmZXJlbmNlIGluIHVzaW5nIHRoaXMgY2FsbGJhY2sgb3IgdGhlIHtAbGluayBmaW5hbGl6ZX1cbiAgICogb3BlcmF0b3IsIGJ1dCBpZiB5b3UncmUgYWxyZWFkeSB1c2luZyBgdGFwYCBvcGVyYXRvciwgeW91IGNhbiB1c2UgdGhpcyBjYWxsYmFja1xuICAgKiBpbnN0ZWFkLiBZb3UnZCBnZXQgdGhlIHNhbWUgcmVzdWx0IGluIGVpdGhlciBjYXNlLlxuICAgKi9cbiAgZmluYWxpemU6ICgpID0+IHZvaWQ7XG59XG5leHBvcnQgZnVuY3Rpb24gdGFwPFQ+KG9ic2VydmVyT3JOZXh0PzogUGFydGlhbDxUYXBPYnNlcnZlcjxUPj4gfCAoKHZhbHVlOiBUKSA9PiB2b2lkKSk6IE1vbm9UeXBlT3BlcmF0b3JGdW5jdGlvbjxUPjtcbi8qKiBAZGVwcmVjYXRlZCBJbnN0ZWFkIG9mIHBhc3Npbmcgc2VwYXJhdGUgY2FsbGJhY2sgYXJndW1lbnRzLCB1c2UgYW4gb2JzZXJ2ZXIgYXJndW1lbnQuIFNpZ25hdHVyZXMgdGFraW5nIHNlcGFyYXRlIGNhbGxiYWNrIGFyZ3VtZW50cyB3aWxsIGJlIHJlbW92ZWQgaW4gdjguIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL3N1YnNjcmliZS1hcmd1bWVudHMgKi9cbmV4cG9ydCBmdW5jdGlvbiB0YXA8VD4oXG4gIG5leHQ/OiAoKHZhbHVlOiBUKSA9PiB2b2lkKSB8IG51bGwsXG4gIGVycm9yPzogKChlcnJvcjogYW55KSA9PiB2b2lkKSB8IG51bGwsXG4gIGNvbXBsZXRlPzogKCgpID0+IHZvaWQpIHwgbnVsbFxuKTogTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uPFQ+O1xuXG4vKipcbiAqIFVzZWQgdG8gcGVyZm9ybSBzaWRlLWVmZmVjdHMgZm9yIG5vdGlmaWNhdGlvbnMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGVcbiAqXG4gKiA8c3BhbiBjbGFzcz1cImluZm9ybWFsXCI+VXNlZCB3aGVuIHlvdSB3YW50IHRvIGFmZmVjdCBvdXRzaWRlIHN0YXRlIHdpdGggYSBub3RpZmljYXRpb24gd2l0aG91dCBhbHRlcmluZyB0aGUgbm90aWZpY2F0aW9uPC9zcGFuPlxuICpcbiAqICFbXSh0YXAucG5nKVxuICpcbiAqIFRhcCBpcyBkZXNpZ25lZCB0byBhbGxvdyB0aGUgZGV2ZWxvcGVyIGEgZGVzaWduYXRlZCBwbGFjZSB0byBwZXJmb3JtIHNpZGUgZWZmZWN0cy4gV2hpbGUgeW91IF9jb3VsZF8gcGVyZm9ybSBzaWRlLWVmZmVjdHNcbiAqIGluc2lkZSBvZiBhIGBtYXBgIG9yIGEgYG1lcmdlTWFwYCwgdGhhdCB3b3VsZCBtYWtlIHRoZWlyIG1hcHBpbmcgZnVuY3Rpb25zIGltcHVyZSwgd2hpY2ggaXNuJ3QgYWx3YXlzIGEgYmlnIGRlYWwsIGJ1dCB3aWxsXG4gKiBtYWtlIGl0IHNvIHlvdSBjYW4ndCBkbyB0aGluZ3MgbGlrZSBtZW1vaXplIHRob3NlIGZ1bmN0aW9ucy4gVGhlIGB0YXBgIG9wZXJhdG9yIGlzIGRlc2lnbmVkIHNvbGVseSBmb3Igc3VjaCBzaWRlLWVmZmVjdHMgdG9cbiAqIGhlbHAgeW91IHJlbW92ZSBzaWRlLWVmZmVjdHMgZnJvbSBvdGhlciBvcGVyYXRpb25zLlxuICpcbiAqIEZvciBhbnkgbm90aWZpY2F0aW9uLCBuZXh0LCBlcnJvciwgb3IgY29tcGxldGUsIGB0YXBgIHdpbGwgY2FsbCB0aGUgYXBwcm9wcmlhdGUgY2FsbGJhY2sgeW91IGhhdmUgcHJvdmlkZWQgdG8gaXQsIHZpYSBhIGZ1bmN0aW9uXG4gKiByZWZlcmVuY2UsIG9yIGEgcGFydGlhbCBvYnNlcnZlciwgdGhlbiBwYXNzIHRoYXQgbm90aWZpY2F0aW9uIGRvd24gdGhlIHN0cmVhbS5cbiAqXG4gKiBUaGUgb2JzZXJ2YWJsZSByZXR1cm5lZCBieSBgdGFwYCBpcyBhbiBleGFjdCBtaXJyb3Igb2YgdGhlIHNvdXJjZSwgd2l0aCBvbmUgZXhjZXB0aW9uOiBBbnkgZXJyb3IgdGhhdCBvY2N1cnMgLS0gc3luY2hyb25vdXNseSAtLSBpbiBhIGhhbmRsZXJcbiAqIHByb3ZpZGVkIHRvIGB0YXBgIHdpbGwgYmUgZW1pdHRlZCBhcyBhbiBlcnJvciBmcm9tIHRoZSByZXR1cm5lZCBvYnNlcnZhYmxlLlxuICpcbiAqID4gQmUgY2FyZWZ1bCEgWW91IGNhbiBtdXRhdGUgb2JqZWN0cyBhcyB0aGV5IHBhc3MgdGhyb3VnaCB0aGUgYHRhcGAgb3BlcmF0b3IncyBoYW5kbGVycy5cbiAqXG4gKiBUaGUgbW9zdCBjb21tb24gdXNlIG9mIGB0YXBgIGlzIGFjdHVhbGx5IGZvciBkZWJ1Z2dpbmcuIFlvdSBjYW4gcGxhY2UgYSBgdGFwKGNvbnNvbGUubG9nKWAgYW55d2hlcmVcbiAqIGluIHlvdXIgb2JzZXJ2YWJsZSBgcGlwZWAsIGxvZyBvdXQgdGhlIG5vdGlmaWNhdGlvbnMgYXMgdGhleSBhcmUgZW1pdHRlZCBieSB0aGUgc291cmNlIHJldHVybmVkIGJ5IHRoZSBwcmV2aW91c1xuICogb3BlcmF0aW9uLlxuICpcbiAqICMjIEV4YW1wbGVzXG4gKlxuICogQ2hlY2sgYSByYW5kb20gbnVtYmVyIGJlZm9yZSBpdCBpcyBoYW5kbGVkLiBCZWxvdyBpcyBhbiBvYnNlcnZhYmxlIHRoYXQgd2lsbCB1c2UgYSByYW5kb20gbnVtYmVyIGJldHdlZW4gMCBhbmQgMSxcbiAqIGFuZCBlbWl0IGAnYmlnJ2Agb3IgYCdzbWFsbCdgIGRlcGVuZGluZyBvbiB0aGUgc2l6ZSBvZiB0aGF0IG51bWJlci4gQnV0IHdlIHdhbnRlZCB0byBsb2cgd2hhdCB0aGUgb3JpZ2luYWwgbnVtYmVyXG4gKiB3YXMsIHNvIHdlIGhhdmUgYWRkZWQgYSBgdGFwKGNvbnNvbGUubG9nKWAuXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IG9mLCB0YXAsIG1hcCB9IGZyb20gJ3J4anMnO1xuICpcbiAqIG9mKE1hdGgucmFuZG9tKCkpLnBpcGUoXG4gKiAgIHRhcChjb25zb2xlLmxvZyksXG4gKiAgIG1hcChuID0+IG4gPiAwLjUgPyAnYmlnJyA6ICdzbWFsbCcpXG4gKiApLnN1YnNjcmliZShjb25zb2xlLmxvZyk7XG4gKiBgYGBcbiAqXG4gKiBVc2luZyBgdGFwYCB0byBhbmFseXplIGEgdmFsdWUgYW5kIGZvcmNlIGFuIGVycm9yLiBCZWxvdyBpcyBhbiBvYnNlcnZhYmxlIHdoZXJlIGluIG91ciBzeXN0ZW0gd2Ugb25seVxuICogd2FudCB0byBlbWl0IG51bWJlcnMgMyBvciBsZXNzIHdlIGdldCBmcm9tIGFub3RoZXIgc291cmNlLiBXZSBjYW4gZm9yY2Ugb3VyIG9ic2VydmFibGUgdG8gZXJyb3JcbiAqIHVzaW5nIGB0YXBgLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBvZiwgdGFwIH0gZnJvbSAncnhqcyc7XG4gKlxuICogY29uc3Qgc291cmNlID0gb2YoMSwgMiwgMywgNCwgNSk7XG4gKlxuICogc291cmNlLnBpcGUoXG4gKiAgIHRhcChuID0+IHtcbiAqICAgICBpZiAobiA+IDMpIHtcbiAqICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFZhbHVlICR7IG4gfSBpcyBncmVhdGVyIHRoYW4gM2ApO1xuICogICAgIH1cbiAqICAgfSlcbiAqIClcbiAqIC5zdWJzY3JpYmUoeyBuZXh0OiBjb25zb2xlLmxvZywgZXJyb3I6IGVyciA9PiBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSkgfSk7XG4gKiBgYGBcbiAqXG4gKiBXZSB3YW50IHRvIGtub3cgd2hlbiBhbiBvYnNlcnZhYmxlIGNvbXBsZXRlcyBiZWZvcmUgbW92aW5nIG9uIHRvIHRoZSBuZXh0IG9ic2VydmFibGUuIFRoZSBzeXN0ZW1cbiAqIGJlbG93IHdpbGwgZW1pdCBhIHJhbmRvbSBzZXJpZXMgb2YgYCdYJ2AgY2hhcmFjdGVycyBmcm9tIDMgZGlmZmVyZW50IG9ic2VydmFibGVzIGluIHNlcXVlbmNlLiBUaGVcbiAqIG9ubHkgd2F5IHdlIGtub3cgd2hlbiBvbmUgb2JzZXJ2YWJsZSBjb21wbGV0ZXMgYW5kIG1vdmVzIHRvIHRoZSBuZXh0IG9uZSwgaW4gdGhpcyBjYXNlLCBpcyBiZWNhdXNlXG4gKiB3ZSBoYXZlIGFkZGVkIGEgYHRhcGAgd2l0aCB0aGUgc2lkZSBlZmZlY3Qgb2YgbG9nZ2luZyB0byBjb25zb2xlLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBvZiwgY29uY2F0TWFwLCBpbnRlcnZhbCwgdGFrZSwgbWFwLCB0YXAgfSBmcm9tICdyeGpzJztcbiAqXG4gKiBvZigxLCAyLCAzKS5waXBlKFxuICogICBjb25jYXRNYXAobiA9PiBpbnRlcnZhbCgxMDAwKS5waXBlKFxuICogICAgIHRha2UoTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTApKSxcbiAqICAgICBtYXAoKCkgPT4gJ1gnKSxcbiAqICAgICB0YXAoeyBjb21wbGV0ZTogKCkgPT4gY29uc29sZS5sb2coYERvbmUgd2l0aCAkeyBuIH1gKSB9KVxuICogICApKVxuICogKVxuICogLnN1YnNjcmliZShjb25zb2xlLmxvZyk7XG4gKiBgYGBcbiAqXG4gKiBAc2VlIHtAbGluayBmaW5hbGl6ZX1cbiAqIEBzZWUge0BsaW5rIFRhcE9ic2VydmVyfVxuICpcbiAqIEBwYXJhbSBvYnNlcnZlck9yTmV4dCBBIG5leHQgaGFuZGxlciBvciBwYXJ0aWFsIG9ic2VydmVyXG4gKiBAcGFyYW0gZXJyb3IgQW4gZXJyb3IgaGFuZGxlclxuICogQHBhcmFtIGNvbXBsZXRlIEEgY29tcGxldGlvbiBoYW5kbGVyXG4gKiBAcmV0dXJuIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIE9ic2VydmFibGUgaWRlbnRpY2FsIHRvIHRoZSBzb3VyY2UsIGJ1dFxuICogcnVucyB0aGUgc3BlY2lmaWVkIE9ic2VydmVyIG9yIGNhbGxiYWNrKHMpIGZvciBlYWNoIGl0ZW0uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0YXA8VD4oXG4gIG9ic2VydmVyT3JOZXh0PzogUGFydGlhbDxUYXBPYnNlcnZlcjxUPj4gfCAoKHZhbHVlOiBUKSA9PiB2b2lkKSB8IG51bGwsXG4gIGVycm9yPzogKChlOiBhbnkpID0+IHZvaWQpIHwgbnVsbCxcbiAgY29tcGxldGU/OiAoKCkgPT4gdm9pZCkgfCBudWxsXG4pOiBNb25vVHlwZU9wZXJhdG9yRnVuY3Rpb248VD4ge1xuICAvLyBXZSBoYXZlIHRvIGNoZWNrIHRvIHNlZSBub3Qgb25seSBpZiBuZXh0IGlzIGEgZnVuY3Rpb24sXG4gIC8vIGJ1dCBpZiBlcnJvciBvciBjb21wbGV0ZSB3ZXJlIHBhc3NlZC4gVGhpcyBpcyBiZWNhdXNlIHNvbWVvbmVcbiAgLy8gY291bGQgdGVjaG5pY2FsbHkgY2FsbCB0YXAgbGlrZSBgdGFwKG51bGwsIGZuKWAgb3IgYHRhcChudWxsLCBudWxsLCBmbilgLlxuICBjb25zdCB0YXBPYnNlcnZlciA9XG4gICAgaXNGdW5jdGlvbihvYnNlcnZlck9yTmV4dCkgfHwgZXJyb3IgfHwgY29tcGxldGVcbiAgICAgID8gLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1vYmplY3QtbGl0ZXJhbC10eXBlLWFzc2VydGlvblxuICAgICAgICAoeyBuZXh0OiBvYnNlcnZlck9yTmV4dCBhcyBFeGNsdWRlPHR5cGVvZiBvYnNlcnZlck9yTmV4dCwgUGFydGlhbDxUYXBPYnNlcnZlcjxUPj4+LCBlcnJvciwgY29tcGxldGUgfSBhcyBQYXJ0aWFsPFRhcE9ic2VydmVyPFQ+PilcbiAgICAgIDogb2JzZXJ2ZXJPck5leHQ7XG5cbiAgcmV0dXJuIHRhcE9ic2VydmVyXG4gICAgPyBvcGVyYXRlKChzb3VyY2UsIHN1YnNjcmliZXIpID0+IHtcbiAgICAgICAgdGFwT2JzZXJ2ZXIuc3Vic2NyaWJlPy4oKTtcbiAgICAgICAgbGV0IGlzVW5zdWIgPSB0cnVlO1xuICAgICAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgICAgIGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihcbiAgICAgICAgICAgIHN1YnNjcmliZXIsXG4gICAgICAgICAgICAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgdGFwT2JzZXJ2ZXIubmV4dD8uKHZhbHVlKTtcbiAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgIGlzVW5zdWIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgdGFwT2JzZXJ2ZXIuY29tcGxldGU/LigpO1xuICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgICAgICBpc1Vuc3ViID0gZmFsc2U7XG4gICAgICAgICAgICAgIHRhcE9ic2VydmVyLmVycm9yPy4oZXJyKTtcbiAgICAgICAgICAgICAgc3Vic2NyaWJlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGlzVW5zdWIpIHtcbiAgICAgICAgICAgICAgICB0YXBPYnNlcnZlci51bnN1YnNjcmliZT8uKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGFwT2JzZXJ2ZXIuZmluYWxpemU/LigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgOiAvLyBUYXAgd2FzIGNhbGxlZCB3aXRoIG5vIHZhbGlkIHRhcCBvYnNlcnZlciBvciBoYW5kbGVyXG4gICAgICAvLyAoZS5nLiBgdGFwKG51bGwsIG51bGwsIG51bGwpYCBvciBgdGFwKG51bGwpYCBvciBgdGFwKClgKVxuICAgICAgLy8gc28gd2UncmUgZ29pbmcgdG8ganVzdCBtaXJyb3IgdGhlIHNvdXJjZS5cbiAgICAgIGlkZW50aXR5O1xufVxuIl19
