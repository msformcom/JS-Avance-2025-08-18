import{innerFrom}from"../observable/innerFrom";import{operate}from"../util/lift";import{createOperatorSubscriber}from"./OperatorSubscriber";function switchMap(p,s){return operate((r,i)=>{let b=null,c=0,e=!1,n=()=>e&&!b&&i.complete();r.subscribe(createOperatorSubscriber(i,e=>{b?.unsubscribe();let t=0,o=c++;innerFrom(p(e,o)).subscribe(b=createOperatorSubscriber(i,r=>i.next(s?s(e,r,o,t++):r),()=>{b=null,n()}))},()=>{e=!0,n()}))})}export{switchMap};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vcGVyYXRvcnMvc3dpdGNoTWFwLnRzIl0sIm5hbWVzIjpbImlubmVyRnJvbSIsIm9wZXJhdGUiLCJjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIiLCJzd2l0Y2hNYXAiLCJwcm9qZWN0IiwicmVzdWx0U2VsZWN0b3IiLCJzb3VyY2UiLCJzdWJzY3JpYmVyIiwibGV0IiwiaW5uZXJTdWJzY3JpYmVyIiwiaW5kZXgiLCJpc0NvbXBsZXRlIiwiY2hlY2tDb21wbGV0ZSIsImNvbXBsZXRlIiwic3Vic2NyaWJlIiwidW5zdWJzY3JpYmUiLCJpbm5lckluZGV4Iiwib3V0ZXJJbmRleCIsInZhbHVlIiwibmV4dCIsImlubmVyVmFsdWUiXSwibWFwcGluZ3MiOiJPQUVTQSxTQUEwQyxLQUF6QixpQ0FDakJDLE9BQTZCLEtBQWQsc0JBQ2ZDLHdCQUFzRCxLQUF0Qix1QkFnRm5DLFNBQVVDLFVBQ2RDLEVBQ0FDLEdBRUEsT0FBT0osUUFBUSxDQUFDSyxFQUFRQyxLQUN0QkMsSUFBSUMsRUFBeUQsS0FDekRDLEVBQVEsRUFFUkMsRUFBYSxDQUFBLEVBSVhDLEVBQWdCLElBQU1ELEdBQWMsQ0FBQ0YsR0FBbUJGLEVBQVdNLFNBQVEsRUFFakZQLEVBQU9RLFVBQ0xaLHlCQUNFSyxFQUNBLElBRUVFLEdBQWlCTSxZQUFXLEVBQzVCUCxJQUFJUSxFQUFhLEVBQ1hDLEVBQWFQLENBQUssR0FFeEJWLFVBQVVJLEVBQVFjLEVBQU9ELENBQVUsQ0FBQyxFQUFFSCxVQUNuQ0wsRUFBa0JQLHlCQUNqQkssRUFJQSxHQUFnQkEsRUFBV1ksS0FBS2QsRUFBaUJBLEVBQWVhLEVBQU9FLEVBQVlILEVBQVlELENBQVUsRUFBRSxFQUFJSSxDQUFVLEVBQ3pILEtBSUVYLEVBQWtCLEtBQ2xCRyxFQUFhLENBQ2YsQ0FBQyxDQUNELENBRU4sRUFDQSxLQUNFRCxFQUFhLENBQUEsRUFDYkMsRUFBYSxDQUNmLENBQUMsQ0FDRixDQUVMLENBQUMsQ0FDSCxRQS9DZ0JULFNBK0NoQiIsImZpbGUiOiJub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvb3BlcmF0b3JzL3N3aXRjaE1hcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuLi9TdWJzY3JpYmVyJztcbmltcG9ydCB7IE9ic2VydmFibGVJbnB1dCwgT3BlcmF0b3JGdW5jdGlvbiwgT2JzZXJ2ZWRWYWx1ZU9mIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgaW5uZXJGcm9tIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9pbm5lckZyb20nO1xuaW1wb3J0IHsgb3BlcmF0ZSB9IGZyb20gJy4uL3V0aWwvbGlmdCc7XG5pbXBvcnQgeyBjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIgfSBmcm9tICcuL09wZXJhdG9yU3Vic2NyaWJlcic7XG5cbi8qIHRzbGludDpkaXNhYmxlOm1heC1saW5lLWxlbmd0aCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN3aXRjaE1hcDxULCBPIGV4dGVuZHMgT2JzZXJ2YWJsZUlucHV0PGFueT4+KFxuICBwcm9qZWN0OiAodmFsdWU6IFQsIGluZGV4OiBudW1iZXIpID0+IE9cbik6IE9wZXJhdG9yRnVuY3Rpb248VCwgT2JzZXJ2ZWRWYWx1ZU9mPE8+Pjtcbi8qKiBAZGVwcmVjYXRlZCBUaGUgYHJlc3VsdFNlbGVjdG9yYCBwYXJhbWV0ZXIgd2lsbCBiZSByZW1vdmVkIGluIHY4LiBVc2UgYW4gaW5uZXIgYG1hcGAgaW5zdGVhZC4gRGV0YWlsczogaHR0cHM6Ly9yeGpzLmRldi9kZXByZWNhdGlvbnMvcmVzdWx0U2VsZWN0b3IgKi9cbmV4cG9ydCBmdW5jdGlvbiBzd2l0Y2hNYXA8VCwgTyBleHRlbmRzIE9ic2VydmFibGVJbnB1dDxhbnk+PihcbiAgcHJvamVjdDogKHZhbHVlOiBULCBpbmRleDogbnVtYmVyKSA9PiBPLFxuICByZXN1bHRTZWxlY3RvcjogdW5kZWZpbmVkXG4pOiBPcGVyYXRvckZ1bmN0aW9uPFQsIE9ic2VydmVkVmFsdWVPZjxPPj47XG4vKiogQGRlcHJlY2F0ZWQgVGhlIGByZXN1bHRTZWxlY3RvcmAgcGFyYW1ldGVyIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4gVXNlIGFuIGlubmVyIGBtYXBgIGluc3RlYWQuIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL3Jlc3VsdFNlbGVjdG9yICovXG5leHBvcnQgZnVuY3Rpb24gc3dpdGNoTWFwPFQsIFIsIE8gZXh0ZW5kcyBPYnNlcnZhYmxlSW5wdXQ8YW55Pj4oXG4gIHByb2plY3Q6ICh2YWx1ZTogVCwgaW5kZXg6IG51bWJlcikgPT4gTyxcbiAgcmVzdWx0U2VsZWN0b3I6IChvdXRlclZhbHVlOiBULCBpbm5lclZhbHVlOiBPYnNlcnZlZFZhbHVlT2Y8Tz4sIG91dGVySW5kZXg6IG51bWJlciwgaW5uZXJJbmRleDogbnVtYmVyKSA9PiBSXG4pOiBPcGVyYXRvckZ1bmN0aW9uPFQsIFI+O1xuLyogdHNsaW50OmVuYWJsZTptYXgtbGluZS1sZW5ndGggKi9cblxuLyoqXG4gKiBQcm9qZWN0cyBlYWNoIHNvdXJjZSB2YWx1ZSB0byBhbiBPYnNlcnZhYmxlIHdoaWNoIGlzIG1lcmdlZCBpbiB0aGUgb3V0cHV0XG4gKiBPYnNlcnZhYmxlLCBlbWl0dGluZyB2YWx1ZXMgb25seSBmcm9tIHRoZSBtb3N0IHJlY2VudGx5IHByb2plY3RlZCBPYnNlcnZhYmxlLlxuICpcbiAqIDxzcGFuIGNsYXNzPVwiaW5mb3JtYWxcIj5NYXBzIGVhY2ggdmFsdWUgdG8gYW4gT2JzZXJ2YWJsZSwgdGhlbiBmbGF0dGVucyBhbGwgb2ZcbiAqIHRoZXNlIGlubmVyIE9ic2VydmFibGVzIHVzaW5nIHtAbGluayBzd2l0Y2hBbGx9Ljwvc3Bhbj5cbiAqXG4gKiAhW10oc3dpdGNoTWFwLnBuZylcbiAqXG4gKiBSZXR1cm5zIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBpdGVtcyBiYXNlZCBvbiBhcHBseWluZyBhIGZ1bmN0aW9uIHRoYXQgeW91XG4gKiBzdXBwbHkgdG8gZWFjaCBpdGVtIGVtaXR0ZWQgYnkgdGhlIHNvdXJjZSBPYnNlcnZhYmxlLCB3aGVyZSB0aGF0IGZ1bmN0aW9uXG4gKiByZXR1cm5zIGFuIChzby1jYWxsZWQgXCJpbm5lclwiKSBPYnNlcnZhYmxlLiBFYWNoIHRpbWUgaXQgb2JzZXJ2ZXMgb25lIG9mIHRoZXNlXG4gKiBpbm5lciBPYnNlcnZhYmxlcywgdGhlIG91dHB1dCBPYnNlcnZhYmxlIGJlZ2lucyBlbWl0dGluZyB0aGUgaXRlbXMgZW1pdHRlZCBieVxuICogdGhhdCBpbm5lciBPYnNlcnZhYmxlLiBXaGVuIGEgbmV3IGlubmVyIE9ic2VydmFibGUgaXMgZW1pdHRlZCwgYHN3aXRjaE1hcGBcbiAqIHN0b3BzIGVtaXR0aW5nIGl0ZW1zIGZyb20gdGhlIGVhcmxpZXItZW1pdHRlZCBpbm5lciBPYnNlcnZhYmxlIGFuZCBiZWdpbnNcbiAqIGVtaXR0aW5nIGl0ZW1zIGZyb20gdGhlIG5ldyBvbmUuIEl0IGNvbnRpbnVlcyB0byBiZWhhdmUgbGlrZSB0aGlzIGZvclxuICogc3Vic2VxdWVudCBpbm5lciBPYnNlcnZhYmxlcy5cbiAqXG4gKiAjIyBFeGFtcGxlXG4gKlxuICogR2VuZXJhdGUgbmV3IE9ic2VydmFibGUgYWNjb3JkaW5nIHRvIHNvdXJjZSBPYnNlcnZhYmxlIHZhbHVlc1xuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBvZiwgc3dpdGNoTWFwIH0gZnJvbSAncnhqcyc7XG4gKlxuICogY29uc3Qgc3dpdGNoZWQgPSBvZigxLCAyLCAzKS5waXBlKHN3aXRjaE1hcCh4ID0+IG9mKHgsIHggKiogMiwgeCAqKiAzKSkpO1xuICogc3dpdGNoZWQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpO1xuICogLy8gb3V0cHV0c1xuICogLy8gMVxuICogLy8gMVxuICogLy8gMVxuICogLy8gMlxuICogLy8gNFxuICogLy8gOFxuICogLy8gM1xuICogLy8gOVxuICogLy8gMjdcbiAqIGBgYFxuICpcbiAqIFJlc3RhcnQgYW4gaW50ZXJ2YWwgT2JzZXJ2YWJsZSBvbiBldmVyeSBjbGljayBldmVudFxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmcm9tRXZlbnQsIHN3aXRjaE1hcCwgaW50ZXJ2YWwgfSBmcm9tICdyeGpzJztcbiAqXG4gKiBjb25zdCBjbGlja3MgPSBmcm9tRXZlbnQoZG9jdW1lbnQsICdjbGljaycpO1xuICogY29uc3QgcmVzdWx0ID0gY2xpY2tzLnBpcGUoc3dpdGNoTWFwKCgpID0+IGludGVydmFsKDEwMDApKSk7XG4gKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpO1xuICogYGBgXG4gKlxuICogQHNlZSB7QGxpbmsgY29uY2F0TWFwfVxuICogQHNlZSB7QGxpbmsgZXhoYXVzdE1hcH1cbiAqIEBzZWUge0BsaW5rIG1lcmdlTWFwfVxuICogQHNlZSB7QGxpbmsgc3dpdGNoQWxsfVxuICogQHNlZSB7QGxpbmsgc3dpdGNoTWFwVG99XG4gKlxuICogQHBhcmFtIHByb2plY3QgQSBmdW5jdGlvbiB0aGF0LCB3aGVuIGFwcGxpZWQgdG8gYW4gaXRlbSBlbWl0dGVkIGJ5IHRoZSBzb3VyY2VcbiAqIE9ic2VydmFibGUsIHJldHVybnMgYW4gT2JzZXJ2YWJsZS5cbiAqIEByZXR1cm4gQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIHRoZSByZXN1bHQgb2ZcbiAqIGFwcGx5aW5nIHRoZSBwcm9qZWN0aW9uIGZ1bmN0aW9uIChhbmQgdGhlIG9wdGlvbmFsIGRlcHJlY2F0ZWRcbiAqIGByZXN1bHRTZWxlY3RvcmApIHRvIGVhY2ggaXRlbSBlbWl0dGVkIGJ5IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSBhbmQgdGFraW5nXG4gKiBvbmx5IHRoZSB2YWx1ZXMgZnJvbSB0aGUgbW9zdCByZWNlbnRseSBwcm9qZWN0ZWQgaW5uZXIgT2JzZXJ2YWJsZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN3aXRjaE1hcDxULCBSLCBPIGV4dGVuZHMgT2JzZXJ2YWJsZUlucHV0PGFueT4+KFxuICBwcm9qZWN0OiAodmFsdWU6IFQsIGluZGV4OiBudW1iZXIpID0+IE8sXG4gIHJlc3VsdFNlbGVjdG9yPzogKG91dGVyVmFsdWU6IFQsIGlubmVyVmFsdWU6IE9ic2VydmVkVmFsdWVPZjxPPiwgb3V0ZXJJbmRleDogbnVtYmVyLCBpbm5lckluZGV4OiBudW1iZXIpID0+IFJcbik6IE9wZXJhdG9yRnVuY3Rpb248VCwgT2JzZXJ2ZWRWYWx1ZU9mPE8+IHwgUj4ge1xuICByZXR1cm4gb3BlcmF0ZSgoc291cmNlLCBzdWJzY3JpYmVyKSA9PiB7XG4gICAgbGV0IGlubmVyU3Vic2NyaWJlcjogU3Vic2NyaWJlcjxPYnNlcnZlZFZhbHVlT2Y8Tz4+IHwgbnVsbCA9IG51bGw7XG4gICAgbGV0IGluZGV4ID0gMDtcbiAgICAvLyBXaGV0aGVyIG9yIG5vdCB0aGUgc291cmNlIHN1YnNjcmlwdGlvbiBoYXMgY29tcGxldGVkXG4gICAgbGV0IGlzQ29tcGxldGUgPSBmYWxzZTtcblxuICAgIC8vIFdlIG9ubHkgY29tcGxldGUgdGhlIHJlc3VsdCBpZiB0aGUgc291cmNlIGlzIGNvbXBsZXRlIEFORCB3ZSBkb24ndCBoYXZlIGFuIGFjdGl2ZSBpbm5lciBzdWJzY3JpcHRpb24uXG4gICAgLy8gVGhpcyBpcyBjYWxsZWQgYm90aCB3aGVuIHRoZSBzb3VyY2UgY29tcGxldGVzIGFuZCB3aGVuIHRoZSBpbm5lcnMgY29tcGxldGUuXG4gICAgY29uc3QgY2hlY2tDb21wbGV0ZSA9ICgpID0+IGlzQ29tcGxldGUgJiYgIWlubmVyU3Vic2NyaWJlciAmJiBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG5cbiAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKFxuICAgICAgICBzdWJzY3JpYmVyLFxuICAgICAgICAodmFsdWUpID0+IHtcbiAgICAgICAgICAvLyBDYW5jZWwgdGhlIHByZXZpb3VzIGlubmVyIHN1YnNjcmlwdGlvbiBpZiB0aGVyZSB3YXMgb25lXG4gICAgICAgICAgaW5uZXJTdWJzY3JpYmVyPy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgIGxldCBpbm5lckluZGV4ID0gMDtcbiAgICAgICAgICBjb25zdCBvdXRlckluZGV4ID0gaW5kZXgrKztcbiAgICAgICAgICAvLyBTdGFydCB0aGUgbmV4dCBpbm5lciBzdWJzY3JpcHRpb25cbiAgICAgICAgICBpbm5lckZyb20ocHJvamVjdCh2YWx1ZSwgb3V0ZXJJbmRleCkpLnN1YnNjcmliZShcbiAgICAgICAgICAgIChpbm5lclN1YnNjcmliZXIgPSBjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoXG4gICAgICAgICAgICAgIHN1YnNjcmliZXIsXG4gICAgICAgICAgICAgIC8vIFdoZW4gd2UgZ2V0IGEgbmV3IGlubmVyIHZhbHVlLCBuZXh0IGl0IHRocm91Z2guIE5vdGUgdGhhdCB0aGlzIGlzXG4gICAgICAgICAgICAgIC8vIGhhbmRsaW5nIHRoZSBkZXByZWNhdGUgcmVzdWx0IHNlbGVjdG9yIGhlcmUuIFRoaXMgaXMgYmVjYXVzZSB3aXRoIHRoaXMgYXJjaGl0ZWN0dXJlXG4gICAgICAgICAgICAgIC8vIGl0IGVuZHMgdXAgYmVpbmcgc21hbGxlciB0aGFuIHVzaW5nIHRoZSBtYXAgb3BlcmF0b3IuXG4gICAgICAgICAgICAgIChpbm5lclZhbHVlKSA9PiBzdWJzY3JpYmVyLm5leHQocmVzdWx0U2VsZWN0b3IgPyByZXN1bHRTZWxlY3Rvcih2YWx1ZSwgaW5uZXJWYWx1ZSwgb3V0ZXJJbmRleCwgaW5uZXJJbmRleCsrKSA6IGlubmVyVmFsdWUpLFxuICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVGhlIGlubmVyIGhhcyBjb21wbGV0ZWQuIE51bGwgb3V0IHRoZSBpbm5lciBzdWJzY3JpYmVyIHRvXG4gICAgICAgICAgICAgICAgLy8gZnJlZSB1cCBtZW1vcnkgYW5kIHRvIHNpZ25hbCB0aGF0IHdlIGhhdmUgbm8gaW5uZXIgc3Vic2NyaXB0aW9uXG4gICAgICAgICAgICAgICAgLy8gY3VycmVudGx5LlxuICAgICAgICAgICAgICAgIGlubmVyU3Vic2NyaWJlciA9IG51bGwhO1xuICAgICAgICAgICAgICAgIGNoZWNrQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKSlcbiAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgaXNDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgY2hlY2tDb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICApXG4gICAgKTtcbiAgfSk7XG59XG4iXX0=
