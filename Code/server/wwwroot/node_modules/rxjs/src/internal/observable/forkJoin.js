import{Observable}from"../Observable";import{argsArgArrayOrObject}from"../util/argsArgArrayOrObject";import{innerFrom}from"./innerFrom";import{popResultSelector}from"../util/args";import{createOperatorSubscriber}from"../operators/OperatorSubscriber";import{mapOneOrManyArgs}from"../util/mapOneOrManyArgs";import{createObject}from"../util/createObject";function forkJoin(...r){var e=popResultSelector(r);let{args:p,keys:m}=argsArgArrayOrObject(r);r=new Observable(i=>{var e=p.length;if(e){let o=new Array(e),r=e,a=e;for(let t=0;t<e;t++){let e=!1;innerFrom(p[t]).subscribe(createOperatorSubscriber(i,r=>{e||(e=!0,a--),o[t]=r},()=>r--,void 0,()=>{r&&e||(a||i.next(m?createObject(m,o):o),i.complete())}))}}else i.complete()});return e?r.pipe(mapOneOrManyArgs(e)):r}export{forkJoin};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vYnNlcnZhYmxlL2ZvcmtKb2luLnRzIl0sIm5hbWVzIjpbIk9ic2VydmFibGUiLCJhcmdzQXJnQXJyYXlPck9iamVjdCIsImlubmVyRnJvbSIsInBvcFJlc3VsdFNlbGVjdG9yIiwiY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyIiwibWFwT25lT3JNYW55QXJncyIsImNyZWF0ZU9iamVjdCIsImZvcmtKb2luIiwiYXJncyIsInJlc3VsdFNlbGVjdG9yIiwic291cmNlcyIsImtleXMiLCJyZXN1bHQiLCJsZW5ndGgiLCJ2YWx1ZXMiLCJBcnJheSIsInJlbWFpbmluZ0NvbXBsZXRpb25zIiwicmVtYWluaW5nRW1pc3Npb25zIiwibGV0Iiwic291cmNlSW5kZXgiLCJoYXNWYWx1ZSIsInN1YnNjcmliZSIsInN1YnNjcmliZXIiLCJ2YWx1ZSIsInVuZGVmaW5lZCIsIm5leHQiLCJjb21wbGV0ZSIsInBpcGUiXSwibWFwcGluZ3MiOiJPQUFTQSxVQUFpQyxLQUFmLHVCQUVsQkMsb0JBQTBELEtBQTlCLHNDQUM1QkMsU0FBOEIsS0FBYixxQkFDakJDLGlCQUF1QyxLQUFkLHNCQUN6QkMsd0JBQWlFLEtBQWpDLHlDQUNoQ0MsZ0JBQWtELEtBQTFCLGtDQUN4QkMsWUFBMEMsS0FBdEIsdUJBeUl2QixTQUFVQyxZQUFZQyxHQUMxQixJQUFNQyxFQUFpQk4sa0JBQWtCSyxDQUFJLEVBQzdDLEdBQU0sQ0FBRUEsS0FBTUUsRUFBU0MsS0FBQUEsQ0FBSSxFQUFLVixxQkFBcUJPLENBQUksRUFDbkRJLEVBQVMsSUFBSVosV0FBVyxJQUM1QixJQUFRYSxFQUFXSCxFQUFMLE9BQ2QsR0FBS0csRUFBTCxDQUlBLElBQU1DLEVBQVMsSUFBSUMsTUFBTUYsQ0FBTSxFQUMzQkcsRUFBdUJILEVBQ3ZCSSxFQUFxQkosRUFDekIsSUFBS0ssSUFBSUMsRUFBYyxFQUFHQSxFQUFjTixFQUFRTSxDQUFXLEdBQUksQ0FDN0RELElBQUlFLEVBQVcsQ0FBQSxFQUNmbEIsVUFBVVEsRUFBUVMsRUFBWSxFQUFFRSxVQUM5QmpCLHlCQUNFa0IsRUFDQSxJQUNPRixJQUNIQSxFQUFXLENBQUEsRUFDWEgsQ0FBa0IsSUFFcEJILEVBQU9LLEdBQWVJLENBQ3hCLEVBQ0EsSUFBTVAsQ0FBb0IsR0FDMUJRLEtBQUFBLEVBQ0EsS0FDT1IsR0FBeUJJLElBQ3ZCSCxHQUNISyxFQUFXRyxLQUFLZCxFQUFPTCxhQUFhSyxFQUFNRyxDQUFNLEVBQUlBLENBQU0sRUFFNURRLEVBQVdJLFNBQVEsRUFFdkIsQ0FBQyxDQUNGLENBRUwsQ0E1QkEsTUFGRUosRUFBV0ksU0FBUSxDQStCdkIsQ0FBQyxFQUNELE9BQU9qQixFQUFpQkcsRUFBT2UsS0FBS3RCLGlCQUFpQkksQ0FBYyxDQUFDLEVBQUlHLENBQzFFLFFBdkNnQkwsUUF1Q2hCIiwiZmlsZSI6Im5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vYnNlcnZhYmxlL2ZvcmtKb2luLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgT2JzZXJ2ZWRWYWx1ZU9mLCBPYnNlcnZhYmxlSW5wdXRUdXBsZSwgT2JzZXJ2YWJsZUlucHV0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgYXJnc0FyZ0FycmF5T3JPYmplY3QgfSBmcm9tICcuLi91dGlsL2FyZ3NBcmdBcnJheU9yT2JqZWN0JztcbmltcG9ydCB7IGlubmVyRnJvbSB9IGZyb20gJy4vaW5uZXJGcm9tJztcbmltcG9ydCB7IHBvcFJlc3VsdFNlbGVjdG9yIH0gZnJvbSAnLi4vdXRpbC9hcmdzJztcbmltcG9ydCB7IGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlciB9IGZyb20gJy4uL29wZXJhdG9ycy9PcGVyYXRvclN1YnNjcmliZXInO1xuaW1wb3J0IHsgbWFwT25lT3JNYW55QXJncyB9IGZyb20gJy4uL3V0aWwvbWFwT25lT3JNYW55QXJncyc7XG5pbXBvcnQgeyBjcmVhdGVPYmplY3QgfSBmcm9tICcuLi91dGlsL2NyZWF0ZU9iamVjdCc7XG5pbXBvcnQgeyBBbnlDYXRjaGVyIH0gZnJvbSAnLi4vQW55Q2F0Y2hlcic7XG5cbi8vIGZvcmtKb2luKGFueSlcbi8vIFdlIHB1dCB0aGlzIGZpcnN0IGJlY2F1c2Ugd2UgbmVlZCB0byBjYXRjaCBjYXNlcyB3aGVyZSB0aGUgdXNlciBoYXMgc3VwcGxpZWRcbi8vIF9leGFjdGx5IGBhbnlgXyBhcyB0aGUgYXJndW1lbnQuIFNpbmNlIGBhbnlgIGxpdGVyYWxseSBtYXRjaGVzIF9hbnl0aGluZ18sXG4vLyB3ZSBkb24ndCB3YW50IGl0IHRvIHJhbmRvbWx5IGhpdCBvbmUgb2YgdGhlIG90aGVyIHR5cGUgc2lnbmF0dXJlcyBiZWxvdyxcbi8vIGFzIHdlIGhhdmUgbm8gaWRlYSBhdCBidWlsZC10aW1lIHdoYXQgdHlwZSB3ZSBzaG91bGQgYmUgcmV0dXJuaW5nIHdoZW4gZ2l2ZW4gYW4gYW55LlxuXG4vKipcbiAqIFlvdSBoYXZlIHBhc3NlZCBgYW55YCBoZXJlLCB3ZSBjYW4ndCBmaWd1cmUgb3V0IGlmIGl0IGlzXG4gKiBhbiBhcnJheSBvciBhbiBvYmplY3QsIHNvIHlvdSdyZSBnZXR0aW5nIGB1bmtub3duYC4gVXNlIGJldHRlciB0eXBlcy5cbiAqIEBwYXJhbSBhcmcgU29tZXRoaW5nIHR5cGVkIGFzIGBhbnlgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JrSm9pbjxUIGV4dGVuZHMgQW55Q2F0Y2hlcj4oYXJnOiBUKTogT2JzZXJ2YWJsZTx1bmtub3duPjtcblxuLy8gZm9ya0pvaW4obnVsbCB8IHVuZGVmaW5lZClcbmV4cG9ydCBmdW5jdGlvbiBmb3JrSm9pbihzY2hlZHVsZXI6IG51bGwgfCB1bmRlZmluZWQpOiBPYnNlcnZhYmxlPG5ldmVyPjtcblxuLy8gZm9ya0pvaW4oW2EsIGIsIGNdKVxuZXhwb3J0IGZ1bmN0aW9uIGZvcmtKb2luKHNvdXJjZXM6IHJlYWRvbmx5IFtdKTogT2JzZXJ2YWJsZTxuZXZlcj47XG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW48QSBleHRlbmRzIHJlYWRvbmx5IHVua25vd25bXT4oc291cmNlczogcmVhZG9ubHkgWy4uLk9ic2VydmFibGVJbnB1dFR1cGxlPEE+XSk6IE9ic2VydmFibGU8QT47XG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW48QSBleHRlbmRzIHJlYWRvbmx5IHVua25vd25bXSwgUj4oXG4gIHNvdXJjZXM6IHJlYWRvbmx5IFsuLi5PYnNlcnZhYmxlSW5wdXRUdXBsZTxBPl0sXG4gIHJlc3VsdFNlbGVjdG9yOiAoLi4udmFsdWVzOiBBKSA9PiBSXG4pOiBPYnNlcnZhYmxlPFI+O1xuXG4vLyBmb3JrSm9pbihhLCBiLCBjKVxuLyoqIEBkZXByZWNhdGVkIFBhc3MgYW4gYXJyYXkgb2Ygc291cmNlcyBpbnN0ZWFkLiBUaGUgcmVzdC1wYXJhbWV0ZXJzIHNpZ25hdHVyZSB3aWxsIGJlIHJlbW92ZWQgaW4gdjguIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL2FycmF5LWFyZ3VtZW50ICovXG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW48QSBleHRlbmRzIHJlYWRvbmx5IHVua25vd25bXT4oLi4uc291cmNlczogWy4uLk9ic2VydmFibGVJbnB1dFR1cGxlPEE+XSk6IE9ic2VydmFibGU8QT47XG4vKiogQGRlcHJlY2F0ZWQgUGFzcyBhbiBhcnJheSBvZiBzb3VyY2VzIGluc3RlYWQuIFRoZSByZXN0LXBhcmFtZXRlcnMgc2lnbmF0dXJlIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4gRGV0YWlsczogaHR0cHM6Ly9yeGpzLmRldi9kZXByZWNhdGlvbnMvYXJyYXktYXJndW1lbnQgKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JrSm9pbjxBIGV4dGVuZHMgcmVhZG9ubHkgdW5rbm93bltdLCBSPihcbiAgLi4uc291cmNlc0FuZFJlc3VsdFNlbGVjdG9yOiBbLi4uT2JzZXJ2YWJsZUlucHV0VHVwbGU8QT4sICguLi52YWx1ZXM6IEEpID0+IFJdXG4pOiBPYnNlcnZhYmxlPFI+O1xuXG4vLyBmb3JrSm9pbih7YSwgYiwgY30pXG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW4oc291cmNlc09iamVjdDogeyBbSyBpbiBhbnldOiBuZXZlciB9KTogT2JzZXJ2YWJsZTxuZXZlcj47XG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW48VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIE9ic2VydmFibGVJbnB1dDxhbnk+Pj4oXG4gIHNvdXJjZXNPYmplY3Q6IFRcbik6IE9ic2VydmFibGU8eyBbSyBpbiBrZXlvZiBUXTogT2JzZXJ2ZWRWYWx1ZU9mPFRbS10+IH0+O1xuXG4vKipcbiAqIEFjY2VwdHMgYW4gYEFycmF5YCBvZiB7QGxpbmsgT2JzZXJ2YWJsZUlucHV0fSBvciBhIGRpY3Rpb25hcnkgYE9iamVjdGAgb2Yge0BsaW5rIE9ic2VydmFibGVJbnB1dH0gYW5kIHJldHVybnNcbiAqIGFuIHtAbGluayBPYnNlcnZhYmxlfSB0aGF0IGVtaXRzIGVpdGhlciBhbiBhcnJheSBvZiB2YWx1ZXMgaW4gdGhlIGV4YWN0IHNhbWUgb3JkZXIgYXMgdGhlIHBhc3NlZCBhcnJheSxcbiAqIG9yIGEgZGljdGlvbmFyeSBvZiB2YWx1ZXMgaW4gdGhlIHNhbWUgc2hhcGUgYXMgdGhlIHBhc3NlZCBkaWN0aW9uYXJ5LlxuICpcbiAqIDxzcGFuIGNsYXNzPVwiaW5mb3JtYWxcIj5XYWl0IGZvciBPYnNlcnZhYmxlcyB0byBjb21wbGV0ZSBhbmQgdGhlbiBjb21iaW5lIGxhc3QgdmFsdWVzIHRoZXkgZW1pdHRlZDtcbiAqIGNvbXBsZXRlIGltbWVkaWF0ZWx5IGlmIGFuIGVtcHR5IGFycmF5IGlzIHBhc3NlZC48L3NwYW4+XG4gKlxuICogIVtdKGZvcmtKb2luLnBuZylcbiAqXG4gKiBgZm9ya0pvaW5gIGlzIGFuIG9wZXJhdG9yIHRoYXQgdGFrZXMgYW55IG51bWJlciBvZiBpbnB1dCBvYnNlcnZhYmxlcyB3aGljaCBjYW4gYmUgcGFzc2VkIGVpdGhlciBhcyBhbiBhcnJheVxuICogb3IgYSBkaWN0aW9uYXJ5IG9mIGlucHV0IG9ic2VydmFibGVzLiBJZiBubyBpbnB1dCBvYnNlcnZhYmxlcyBhcmUgcHJvdmlkZWQgKGUuZy4gYW4gZW1wdHkgYXJyYXkgaXMgcGFzc2VkKSxcbiAqIHRoZW4gdGhlIHJlc3VsdGluZyBzdHJlYW0gd2lsbCBjb21wbGV0ZSBpbW1lZGlhdGVseS5cbiAqXG4gKiBgZm9ya0pvaW5gIHdpbGwgd2FpdCBmb3IgYWxsIHBhc3NlZCBvYnNlcnZhYmxlcyB0byBlbWl0IGFuZCBjb21wbGV0ZSBhbmQgdGhlbiBpdCB3aWxsIGVtaXQgYW4gYXJyYXkgb3IgYW4gb2JqZWN0IHdpdGggbGFzdFxuICogdmFsdWVzIGZyb20gY29ycmVzcG9uZGluZyBvYnNlcnZhYmxlcy5cbiAqXG4gKiBJZiB5b3UgcGFzcyBhbiBhcnJheSBvZiBgbmAgb2JzZXJ2YWJsZXMgdG8gdGhlIG9wZXJhdG9yLCB0aGVuIHRoZSByZXN1bHRpbmdcbiAqIGFycmF5IHdpbGwgaGF2ZSBgbmAgdmFsdWVzLCB3aGVyZSB0aGUgZmlyc3QgdmFsdWUgaXMgdGhlIGxhc3Qgb25lIGVtaXR0ZWQgYnkgdGhlIGZpcnN0IG9ic2VydmFibGUsXG4gKiBzZWNvbmQgdmFsdWUgaXMgdGhlIGxhc3Qgb25lIGVtaXR0ZWQgYnkgdGhlIHNlY29uZCBvYnNlcnZhYmxlIGFuZCBzbyBvbi5cbiAqXG4gKiBJZiB5b3UgcGFzcyBhIGRpY3Rpb25hcnkgb2Ygb2JzZXJ2YWJsZXMgdG8gdGhlIG9wZXJhdG9yLCB0aGVuIHRoZSByZXN1bHRpbmdcbiAqIG9iamVjdHMgd2lsbCBoYXZlIHRoZSBzYW1lIGtleXMgYXMgdGhlIGRpY3Rpb25hcnkgcGFzc2VkLCB3aXRoIHRoZWlyIGxhc3QgdmFsdWVzIHRoZXkgaGF2ZSBlbWl0dGVkXG4gKiBsb2NhdGVkIGF0IHRoZSBjb3JyZXNwb25kaW5nIGtleS5cbiAqXG4gKiBUaGF0IG1lYW5zIGBmb3JrSm9pbmAgd2lsbCBub3QgZW1pdCBtb3JlIHRoYW4gb25jZSBhbmQgaXQgd2lsbCBjb21wbGV0ZSBhZnRlciB0aGF0LiBJZiB5b3UgbmVlZCB0byBlbWl0IGNvbWJpbmVkXG4gKiB2YWx1ZXMgbm90IG9ubHkgYXQgdGhlIGVuZCBvZiB0aGUgbGlmZWN5Y2xlIG9mIHBhc3NlZCBvYnNlcnZhYmxlcywgYnV0IGFsc28gdGhyb3VnaG91dCBpdCwgdHJ5IG91dCB7QGxpbmsgY29tYmluZUxhdGVzdH1cbiAqIG9yIHtAbGluayB6aXB9IGluc3RlYWQuXG4gKlxuICogSW4gb3JkZXIgZm9yIHRoZSByZXN1bHRpbmcgYXJyYXkgdG8gaGF2ZSB0aGUgc2FtZSBsZW5ndGggYXMgdGhlIG51bWJlciBvZiBpbnB1dCBvYnNlcnZhYmxlcywgd2hlbmV2ZXIgYW55IG9mXG4gKiB0aGUgZ2l2ZW4gb2JzZXJ2YWJsZXMgY29tcGxldGVzIHdpdGhvdXQgZW1pdHRpbmcgYW55IHZhbHVlLCBgZm9ya0pvaW5gIHdpbGwgY29tcGxldGUgYXQgdGhhdCBtb21lbnQgYXMgd2VsbFxuICogYW5kIGl0IHdpbGwgbm90IGVtaXQgYW55dGhpbmcgZWl0aGVyLCBldmVuIGlmIGl0IGFscmVhZHkgaGFzIHNvbWUgbGFzdCB2YWx1ZXMgZnJvbSBvdGhlciBvYnNlcnZhYmxlcy5cbiAqIENvbnZlcnNlbHksIGlmIHRoZXJlIGlzIGFuIG9ic2VydmFibGUgdGhhdCBuZXZlciBjb21wbGV0ZXMsIGBmb3JrSm9pbmAgd2lsbCBuZXZlciBjb21wbGV0ZSBlaXRoZXIsXG4gKiB1bmxlc3MgYXQgYW55IHBvaW50IHNvbWUgb3RoZXIgb2JzZXJ2YWJsZSBjb21wbGV0ZXMgd2l0aG91dCBlbWl0dGluZyBhIHZhbHVlLCB3aGljaCBicmluZ3MgdXMgYmFjayB0b1xuICogdGhlIHByZXZpb3VzIGNhc2UuIE92ZXJhbGwsIGluIG9yZGVyIGZvciBgZm9ya0pvaW5gIHRvIGVtaXQgYSB2YWx1ZSwgYWxsIGdpdmVuIG9ic2VydmFibGVzXG4gKiBoYXZlIHRvIGVtaXQgc29tZXRoaW5nIGF0IGxlYXN0IG9uY2UgYW5kIGNvbXBsZXRlLlxuICpcbiAqIElmIGFueSBnaXZlbiBvYnNlcnZhYmxlIGVycm9ycyBhdCBzb21lIHBvaW50LCBgZm9ya0pvaW5gIHdpbGwgZXJyb3IgYXMgd2VsbCBhbmQgaW1tZWRpYXRlbHkgdW5zdWJzY3JpYmVcbiAqIGZyb20gdGhlIG90aGVyIG9ic2VydmFibGVzLlxuICpcbiAqIE9wdGlvbmFsbHkgYGZvcmtKb2luYCBhY2NlcHRzIGEgYHJlc3VsdFNlbGVjdG9yYCBmdW5jdGlvbiwgdGhhdCB3aWxsIGJlIGNhbGxlZCB3aXRoIHZhbHVlcyB3aGljaCBub3JtYWxseVxuICogd291bGQgbGFuZCBpbiB0aGUgZW1pdHRlZCBhcnJheS4gV2hhdGV2ZXIgaXMgcmV0dXJuZWQgYnkgdGhlIGByZXN1bHRTZWxlY3RvcmAsIHdpbGwgYXBwZWFyIGluIHRoZSBvdXRwdXRcbiAqIG9ic2VydmFibGUgaW5zdGVhZC4gVGhpcyBtZWFucyB0aGF0IHRoZSBkZWZhdWx0IGByZXN1bHRTZWxlY3RvcmAgY2FuIGJlIHRob3VnaHQgb2YgYXMgYSBmdW5jdGlvbiB0aGF0IHRha2VzXG4gKiBhbGwgaXRzIGFyZ3VtZW50cyBhbmQgcHV0cyB0aGVtIGludG8gYW4gYXJyYXkuIE5vdGUgdGhhdCB0aGUgYHJlc3VsdFNlbGVjdG9yYCB3aWxsIGJlIGNhbGxlZCBvbmx5XG4gKiB3aGVuIGBmb3JrSm9pbmAgaXMgc3VwcG9zZWQgdG8gZW1pdCBhIHJlc3VsdC5cbiAqXG4gKiAjIyBFeGFtcGxlc1xuICpcbiAqIFVzZSBgZm9ya0pvaW5gIHdpdGggYSBkaWN0aW9uYXJ5IG9mIG9ic2VydmFibGUgaW5wdXRzXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGZvcmtKb2luLCBvZiwgdGltZXIgfSBmcm9tICdyeGpzJztcbiAqXG4gKiBjb25zdCBvYnNlcnZhYmxlID0gZm9ya0pvaW4oe1xuICogICBmb286IG9mKDEsIDIsIDMsIDQpLFxuICogICBiYXI6IFByb21pc2UucmVzb2x2ZSg4KSxcbiAqICAgYmF6OiB0aW1lcig0MDAwKVxuICogfSk7XG4gKiBvYnNlcnZhYmxlLnN1YnNjcmliZSh7XG4gKiAgbmV4dDogdmFsdWUgPT4gY29uc29sZS5sb2codmFsdWUpLFxuICogIGNvbXBsZXRlOiAoKSA9PiBjb25zb2xlLmxvZygnVGhpcyBpcyBob3cgaXQgZW5kcyEnKSxcbiAqIH0pO1xuICpcbiAqIC8vIExvZ3M6XG4gKiAvLyB7IGZvbzogNCwgYmFyOiA4LCBiYXo6IDAgfSBhZnRlciA0IHNlY29uZHNcbiAqIC8vICdUaGlzIGlzIGhvdyBpdCBlbmRzIScgaW1tZWRpYXRlbHkgYWZ0ZXJcbiAqIGBgYFxuICpcbiAqIFVzZSBgZm9ya0pvaW5gIHdpdGggYW4gYXJyYXkgb2Ygb2JzZXJ2YWJsZSBpbnB1dHNcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZm9ya0pvaW4sIG9mLCB0aW1lciB9IGZyb20gJ3J4anMnO1xuICpcbiAqIGNvbnN0IG9ic2VydmFibGUgPSBmb3JrSm9pbihbXG4gKiAgIG9mKDEsIDIsIDMsIDQpLFxuICogICBQcm9taXNlLnJlc29sdmUoOCksXG4gKiAgIHRpbWVyKDQwMDApXG4gKiBdKTtcbiAqIG9ic2VydmFibGUuc3Vic2NyaWJlKHtcbiAqICBuZXh0OiB2YWx1ZSA9PiBjb25zb2xlLmxvZyh2YWx1ZSksXG4gKiAgY29tcGxldGU6ICgpID0+IGNvbnNvbGUubG9nKCdUaGlzIGlzIGhvdyBpdCBlbmRzIScpLFxuICogfSk7XG4gKlxuICogLy8gTG9nczpcbiAqIC8vIFs0LCA4LCAwXSBhZnRlciA0IHNlY29uZHNcbiAqIC8vICdUaGlzIGlzIGhvdyBpdCBlbmRzIScgaW1tZWRpYXRlbHkgYWZ0ZXJcbiAqIGBgYFxuICpcbiAqIEBzZWUge0BsaW5rIGNvbWJpbmVMYXRlc3R9XG4gKiBAc2VlIHtAbGluayB6aXB9XG4gKlxuICogQHBhcmFtIGFyZ3MgQW55IG51bWJlciBvZiBgT2JzZXJ2YWJsZUlucHV0YHMgcHJvdmlkZWQgZWl0aGVyIGFzIGFuIGFycmF5LCBhcyBhbiBvYmplY3RcbiAqIG9yIGFzIGFyZ3VtZW50cyBwYXNzZWQgZGlyZWN0bHkgdG8gdGhlIG9wZXJhdG9yLlxuICogQHJldHVybiBPYnNlcnZhYmxlIGVtaXR0aW5nIGVpdGhlciBhbiBhcnJheSBvZiBsYXN0IHZhbHVlcyBlbWl0dGVkIGJ5IHBhc3NlZCBPYnNlcnZhYmxlc1xuICogb3IgdmFsdWUgZnJvbSBwcm9qZWN0IGZ1bmN0aW9uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW4oLi4uYXJnczogYW55W10pOiBPYnNlcnZhYmxlPGFueT4ge1xuICBjb25zdCByZXN1bHRTZWxlY3RvciA9IHBvcFJlc3VsdFNlbGVjdG9yKGFyZ3MpO1xuICBjb25zdCB7IGFyZ3M6IHNvdXJjZXMsIGtleXMgfSA9IGFyZ3NBcmdBcnJheU9yT2JqZWN0KGFyZ3MpO1xuICBjb25zdCByZXN1bHQgPSBuZXcgT2JzZXJ2YWJsZSgoc3Vic2NyaWJlcikgPT4ge1xuICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSBzb3VyY2VzO1xuICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuICAgIGxldCByZW1haW5pbmdDb21wbGV0aW9ucyA9IGxlbmd0aDtcbiAgICBsZXQgcmVtYWluaW5nRW1pc3Npb25zID0gbGVuZ3RoO1xuICAgIGZvciAobGV0IHNvdXJjZUluZGV4ID0gMDsgc291cmNlSW5kZXggPCBsZW5ndGg7IHNvdXJjZUluZGV4KyspIHtcbiAgICAgIGxldCBoYXNWYWx1ZSA9IGZhbHNlO1xuICAgICAgaW5uZXJGcm9tKHNvdXJjZXNbc291cmNlSW5kZXhdKS5zdWJzY3JpYmUoXG4gICAgICAgIGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihcbiAgICAgICAgICBzdWJzY3JpYmVyLFxuICAgICAgICAgICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFoYXNWYWx1ZSkge1xuICAgICAgICAgICAgICBoYXNWYWx1ZSA9IHRydWU7XG4gICAgICAgICAgICAgIHJlbWFpbmluZ0VtaXNzaW9ucy0tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVzW3NvdXJjZUluZGV4XSA9IHZhbHVlO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgKCkgPT4gcmVtYWluaW5nQ29tcGxldGlvbnMtLSxcbiAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFyZW1haW5pbmdDb21wbGV0aW9ucyB8fCAhaGFzVmFsdWUpIHtcbiAgICAgICAgICAgICAgaWYgKCFyZW1haW5pbmdFbWlzc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoa2V5cyA/IGNyZWF0ZU9iamVjdChrZXlzLCB2YWx1ZXMpIDogdmFsdWVzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHRTZWxlY3RvciA/IHJlc3VsdC5waXBlKG1hcE9uZU9yTWFueUFyZ3MocmVzdWx0U2VsZWN0b3IpKSA6IHJlc3VsdDtcbn1cbiJdfQ==
