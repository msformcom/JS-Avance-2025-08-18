import{AsyncAction}from"./AsyncAction";import{immediateProvider}from"./immediateProvider";class AsapAction extends AsyncAction{constructor(e,i){super(e,i),this.scheduler=e,this.work=i}requestAsyncId(e,i,s=0){return null!==s&&0<s?super.requestAsyncId(e,i,s):(e.actions.push(this),e._scheduled||(e._scheduled=immediateProvider.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,i,s=0){if(null!=s?0<s:0<this.delay)return super.recycleAsyncId(e,i,s);s=e.actions;null!=i&&s[s.length-1]?.id!==i&&(immediateProvider.clearImmediate(i),e._scheduled===i)&&(e._scheduled=void 0)}}export{AsapAction};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zY2hlZHVsZXIvQXNhcEFjdGlvbi50cyJdLCJuYW1lcyI6WyJBc3luY0FjdGlvbiIsImltbWVkaWF0ZVByb3ZpZGVyIiwiQXNhcEFjdGlvbiIsImNvbnN0cnVjdG9yIiwic2NoZWR1bGVyIiwid29yayIsInN1cGVyIiwidGhpcyIsInJlcXVlc3RBc3luY0lkIiwiaWQiLCJkZWxheSIsImFjdGlvbnMiLCJwdXNoIiwiX3NjaGVkdWxlZCIsInNldEltbWVkaWF0ZSIsImZsdXNoIiwiYmluZCIsInVuZGVmaW5lZCIsInJlY3ljbGVBc3luY0lkIiwibGVuZ3RoIiwiY2xlYXJJbW1lZGlhdGUiXSwibWFwcGluZ3MiOiJPQUFTQSxXQUFrQyxLQUFmLHVCQUduQkMsaUJBQThDLEtBQXJCLDRCQUdyQkMsbUJBQXNCRixZQUNqQ0csWUFBc0JDLEVBQW9DQyxHQUN4REMsTUFBTUYsRUFBV0MsQ0FBSSxFQURERSxLQUFBSCxVQUFBQSxFQUFvQ0csS0FBQUYsS0FBQUEsQ0FFMUQsQ0FFVUcsZUFBZUosRUFBMEJLLEVBQWtCQyxFQUFnQixHQUVuRixPQUFjLE9BQVZBLEdBQTBCLEVBQVJBLEVBQ2JKLE1BQU1FLGVBQWVKLEVBQVdLLEVBQUlDLENBQUssR0FHbEROLEVBQVVPLFFBQVFDLEtBQUtMLElBQUksRUFJcEJILEVBQVVTLGFBQWVULEVBQVVTLFdBQWFaLGtCQUFrQmEsYUFBYVYsRUFBVVcsTUFBTUMsS0FBS1osRUFBV2EsS0FBQUEsQ0FBUyxDQUFDLEdBQ2xJLENBRVVDLGVBQWVkLEVBQTBCSyxFQUFrQkMsRUFBZ0IsR0FJbkYsR0FBYSxNQUFUQSxFQUF3QixFQUFSQSxFQUF5QixFQUFiSCxLQUFLRyxNQUNuQyxPQUFPSixNQUFNWSxlQUFlZCxFQUFXSyxFQUFJQyxDQUFLLEVBSzFDQyxFQUFZUCxFQUFMLFFBQ0wsTUFBTkssR0FBY0UsRUFBUUEsRUFBUVEsT0FBUyxJQUFJVixLQUFPQSxJQUNwRFIsa0JBQWtCbUIsZUFBZVgsQ0FBRSxFQUMvQkwsRUFBVVMsYUFBZUosS0FDM0JMLEVBQVVTLFdBQWFJLEtBQUFBLEVBSzdCLEMsUUFyQ1dmLFUiLCJmaWxlIjoibm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3NjaGVkdWxlci9Bc2FwQWN0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNBY3Rpb24gfSBmcm9tICcuL0FzeW5jQWN0aW9uJztcbmltcG9ydCB7IEFzYXBTY2hlZHVsZXIgfSBmcm9tICcuL0FzYXBTY2hlZHVsZXInO1xuaW1wb3J0IHsgU2NoZWR1bGVyQWN0aW9uIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgaW1tZWRpYXRlUHJvdmlkZXIgfSBmcm9tICcuL2ltbWVkaWF0ZVByb3ZpZGVyJztcbmltcG9ydCB7IFRpbWVySGFuZGxlIH0gZnJvbSAnLi90aW1lckhhbmRsZSc7XG5cbmV4cG9ydCBjbGFzcyBBc2FwQWN0aW9uPFQ+IGV4dGVuZHMgQXN5bmNBY3Rpb248VD4ge1xuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgc2NoZWR1bGVyOiBBc2FwU2NoZWR1bGVyLCBwcm90ZWN0ZWQgd29yazogKHRoaXM6IFNjaGVkdWxlckFjdGlvbjxUPiwgc3RhdGU/OiBUKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoc2NoZWR1bGVyLCB3b3JrKTtcbiAgfVxuXG4gIHByb3RlY3RlZCByZXF1ZXN0QXN5bmNJZChzY2hlZHVsZXI6IEFzYXBTY2hlZHVsZXIsIGlkPzogVGltZXJIYW5kbGUsIGRlbGF5OiBudW1iZXIgPSAwKTogVGltZXJIYW5kbGUge1xuICAgIC8vIElmIGRlbGF5IGlzIGdyZWF0ZXIgdGhhbiAwLCByZXF1ZXN0IGFzIGFuIGFzeW5jIGFjdGlvbi5cbiAgICBpZiAoZGVsYXkgIT09IG51bGwgJiYgZGVsYXkgPiAwKSB7XG4gICAgICByZXR1cm4gc3VwZXIucmVxdWVzdEFzeW5jSWQoc2NoZWR1bGVyLCBpZCwgZGVsYXkpO1xuICAgIH1cbiAgICAvLyBQdXNoIHRoZSBhY3Rpb24gdG8gdGhlIGVuZCBvZiB0aGUgc2NoZWR1bGVyIHF1ZXVlLlxuICAgIHNjaGVkdWxlci5hY3Rpb25zLnB1c2godGhpcyk7XG4gICAgLy8gSWYgYSBtaWNyb3Rhc2sgaGFzIGFscmVhZHkgYmVlbiBzY2hlZHVsZWQsIGRvbid0IHNjaGVkdWxlIGFub3RoZXJcbiAgICAvLyBvbmUuIElmIGEgbWljcm90YXNrIGhhc24ndCBiZWVuIHNjaGVkdWxlZCB5ZXQsIHNjaGVkdWxlIG9uZSBub3cuIFJldHVyblxuICAgIC8vIHRoZSBjdXJyZW50IHNjaGVkdWxlZCBtaWNyb3Rhc2sgaWQuXG4gICAgcmV0dXJuIHNjaGVkdWxlci5fc2NoZWR1bGVkIHx8IChzY2hlZHVsZXIuX3NjaGVkdWxlZCA9IGltbWVkaWF0ZVByb3ZpZGVyLnNldEltbWVkaWF0ZShzY2hlZHVsZXIuZmx1c2guYmluZChzY2hlZHVsZXIsIHVuZGVmaW5lZCkpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCByZWN5Y2xlQXN5bmNJZChzY2hlZHVsZXI6IEFzYXBTY2hlZHVsZXIsIGlkPzogVGltZXJIYW5kbGUsIGRlbGF5OiBudW1iZXIgPSAwKTogVGltZXJIYW5kbGUgfCB1bmRlZmluZWQge1xuICAgIC8vIElmIGRlbGF5IGV4aXN0cyBhbmQgaXMgZ3JlYXRlciB0aGFuIDAsIG9yIGlmIHRoZSBkZWxheSBpcyBudWxsICh0aGVcbiAgICAvLyBhY3Rpb24gd2Fzbid0IHJlc2NoZWR1bGVkKSBidXQgd2FzIG9yaWdpbmFsbHkgc2NoZWR1bGVkIGFzIGFuIGFzeW5jXG4gICAgLy8gYWN0aW9uLCB0aGVuIHJlY3ljbGUgYXMgYW4gYXN5bmMgYWN0aW9uLlxuICAgIGlmIChkZWxheSAhPSBudWxsID8gZGVsYXkgPiAwIDogdGhpcy5kZWxheSA+IDApIHtcbiAgICAgIHJldHVybiBzdXBlci5yZWN5Y2xlQXN5bmNJZChzY2hlZHVsZXIsIGlkLCBkZWxheSk7XG4gICAgfVxuICAgIC8vIElmIHRoZSBzY2hlZHVsZXIgcXVldWUgaGFzIG5vIHJlbWFpbmluZyBhY3Rpb25zIHdpdGggdGhlIHNhbWUgYXN5bmMgaWQsXG4gICAgLy8gY2FuY2VsIHRoZSByZXF1ZXN0ZWQgbWljcm90YXNrIGFuZCBzZXQgdGhlIHNjaGVkdWxlZCBmbGFnIHRvIHVuZGVmaW5lZFxuICAgIC8vIHNvIHRoZSBuZXh0IEFzYXBBY3Rpb24gd2lsbCByZXF1ZXN0IGl0cyBvd24uXG4gICAgY29uc3QgeyBhY3Rpb25zIH0gPSBzY2hlZHVsZXI7XG4gICAgaWYgKGlkICE9IG51bGwgJiYgYWN0aW9uc1thY3Rpb25zLmxlbmd0aCAtIDFdPy5pZCAhPT0gaWQpIHtcbiAgICAgIGltbWVkaWF0ZVByb3ZpZGVyLmNsZWFySW1tZWRpYXRlKGlkKTtcbiAgICAgIGlmIChzY2hlZHVsZXIuX3NjaGVkdWxlZCA9PT0gaWQpIHtcbiAgICAgICAgc2NoZWR1bGVyLl9zY2hlZHVsZWQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIFJldHVybiB1bmRlZmluZWQgc28gdGhlIGFjdGlvbiBrbm93cyB0byByZXF1ZXN0IGEgbmV3IGFzeW5jIGlkIGlmIGl0J3MgcmVzY2hlZHVsZWQuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuIl19
