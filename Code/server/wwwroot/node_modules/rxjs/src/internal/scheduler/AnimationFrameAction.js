import{AsyncAction}from"./AsyncAction";import{animationFrameProvider}from"./animationFrameProvider";class AnimationFrameAction extends AsyncAction{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,i=0){return null!==i&&0<i?super.requestAsyncId(e,n,i):(e.actions.push(this),e._scheduled||(e._scheduled=animationFrameProvider.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,n,i=0){if(null!=i?0<i:0<this.delay)return super.recycleAsyncId(e,n,i);i=e.actions;null!=n&&n===e._scheduled&&i[i.length-1]?.id!==n&&(animationFrameProvider.cancelAnimationFrame(n),e._scheduled=void 0)}}export{AnimationFrameAction};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zY2hlZHVsZXIvQW5pbWF0aW9uRnJhbWVBY3Rpb24udHMiXSwibmFtZXMiOlsiQXN5bmNBY3Rpb24iLCJhbmltYXRpb25GcmFtZVByb3ZpZGVyIiwiQW5pbWF0aW9uRnJhbWVBY3Rpb24iLCJjb25zdHJ1Y3RvciIsInNjaGVkdWxlciIsIndvcmsiLCJzdXBlciIsInRoaXMiLCJyZXF1ZXN0QXN5bmNJZCIsImlkIiwiZGVsYXkiLCJhY3Rpb25zIiwicHVzaCIsIl9zY2hlZHVsZWQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJmbHVzaCIsInVuZGVmaW5lZCIsInJlY3ljbGVBc3luY0lkIiwibGVuZ3RoIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiXSwibWFwcGluZ3MiOiJPQUFTQSxXQUFrQyxLQUFmLHVCQUduQkMsc0JBQXdELEtBQTFCLGlDQUcxQkMsNkJBQWdDRixZQUMzQ0csWUFBc0JDLEVBQThDQyxHQUNsRUMsTUFBTUYsRUFBV0MsQ0FBSSxFQURERSxLQUFBSCxVQUFBQSxFQUE4Q0csS0FBQUYsS0FBQUEsQ0FFcEUsQ0FFVUcsZUFBZUosRUFBb0NLLEVBQWtCQyxFQUFnQixHQUU3RixPQUFjLE9BQVZBLEdBQTBCLEVBQVJBLEVBQ2JKLE1BQU1FLGVBQWVKLEVBQVdLLEVBQUlDLENBQUssR0FHbEROLEVBQVVPLFFBQVFDLEtBQUtMLElBQUksRUFJcEJILEVBQVVTLGFBQWVULEVBQVVTLFdBQWFaLHVCQUF1QmEsc0JBQXNCLElBQU1WLEVBQVVXLE1BQU1DLEtBQUFBLENBQVMsQ0FBQyxHQUN0SSxDQUVVQyxlQUFlYixFQUFvQ0ssRUFBa0JDLEVBQWdCLEdBSTdGLEdBQWEsTUFBVEEsRUFBd0IsRUFBUkEsRUFBeUIsRUFBYkgsS0FBS0csTUFDbkMsT0FBT0osTUFBTVcsZUFBZWIsRUFBV0ssRUFBSUMsQ0FBSyxFQUsxQ0MsRUFBWVAsRUFBTCxRQUNMLE1BQU5LLEdBQWNBLElBQU9MLEVBQVVTLFlBQWNGLEVBQVFBLEVBQVFPLE9BQVMsSUFBSVQsS0FBT0EsSUFDbkZSLHVCQUF1QmtCLHFCQUFxQlYsQ0FBWSxFQUN4REwsRUFBVVMsV0FBYUcsS0FBQUEsRUFJM0IsQyxRQW5DV2Qsb0IiLCJmaWxlIjoibm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3NjaGVkdWxlci9BbmltYXRpb25GcmFtZUFjdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jQWN0aW9uIH0gZnJvbSAnLi9Bc3luY0FjdGlvbic7XG5pbXBvcnQgeyBBbmltYXRpb25GcmFtZVNjaGVkdWxlciB9IGZyb20gJy4vQW5pbWF0aW9uRnJhbWVTY2hlZHVsZXInO1xuaW1wb3J0IHsgU2NoZWR1bGVyQWN0aW9uIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgYW5pbWF0aW9uRnJhbWVQcm92aWRlciB9IGZyb20gJy4vYW5pbWF0aW9uRnJhbWVQcm92aWRlcic7XG5pbXBvcnQgeyBUaW1lckhhbmRsZSB9IGZyb20gJy4vdGltZXJIYW5kbGUnO1xuXG5leHBvcnQgY2xhc3MgQW5pbWF0aW9uRnJhbWVBY3Rpb248VD4gZXh0ZW5kcyBBc3luY0FjdGlvbjxUPiB7XG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBzY2hlZHVsZXI6IEFuaW1hdGlvbkZyYW1lU2NoZWR1bGVyLCBwcm90ZWN0ZWQgd29yazogKHRoaXM6IFNjaGVkdWxlckFjdGlvbjxUPiwgc3RhdGU/OiBUKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoc2NoZWR1bGVyLCB3b3JrKTtcbiAgfVxuXG4gIHByb3RlY3RlZCByZXF1ZXN0QXN5bmNJZChzY2hlZHVsZXI6IEFuaW1hdGlvbkZyYW1lU2NoZWR1bGVyLCBpZD86IFRpbWVySGFuZGxlLCBkZWxheTogbnVtYmVyID0gMCk6IFRpbWVySGFuZGxlIHtcbiAgICAvLyBJZiBkZWxheSBpcyBncmVhdGVyIHRoYW4gMCwgcmVxdWVzdCBhcyBhbiBhc3luYyBhY3Rpb24uXG4gICAgaWYgKGRlbGF5ICE9PSBudWxsICYmIGRlbGF5ID4gMCkge1xuICAgICAgcmV0dXJuIHN1cGVyLnJlcXVlc3RBc3luY0lkKHNjaGVkdWxlciwgaWQsIGRlbGF5KTtcbiAgICB9XG4gICAgLy8gUHVzaCB0aGUgYWN0aW9uIHRvIHRoZSBlbmQgb2YgdGhlIHNjaGVkdWxlciBxdWV1ZS5cbiAgICBzY2hlZHVsZXIuYWN0aW9ucy5wdXNoKHRoaXMpO1xuICAgIC8vIElmIGFuIGFuaW1hdGlvbiBmcmFtZSBoYXMgYWxyZWFkeSBiZWVuIHJlcXVlc3RlZCwgZG9uJ3QgcmVxdWVzdCBhbm90aGVyXG4gICAgLy8gb25lLiBJZiBhbiBhbmltYXRpb24gZnJhbWUgaGFzbid0IGJlZW4gcmVxdWVzdGVkIHlldCwgcmVxdWVzdCBvbmUuIFJldHVyblxuICAgIC8vIHRoZSBjdXJyZW50IGFuaW1hdGlvbiBmcmFtZSByZXF1ZXN0IGlkLlxuICAgIHJldHVybiBzY2hlZHVsZXIuX3NjaGVkdWxlZCB8fCAoc2NoZWR1bGVyLl9zY2hlZHVsZWQgPSBhbmltYXRpb25GcmFtZVByb3ZpZGVyLnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBzY2hlZHVsZXIuZmx1c2godW5kZWZpbmVkKSkpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHJlY3ljbGVBc3luY0lkKHNjaGVkdWxlcjogQW5pbWF0aW9uRnJhbWVTY2hlZHVsZXIsIGlkPzogVGltZXJIYW5kbGUsIGRlbGF5OiBudW1iZXIgPSAwKTogVGltZXJIYW5kbGUgfCB1bmRlZmluZWQge1xuICAgIC8vIElmIGRlbGF5IGV4aXN0cyBhbmQgaXMgZ3JlYXRlciB0aGFuIDAsIG9yIGlmIHRoZSBkZWxheSBpcyBudWxsICh0aGVcbiAgICAvLyBhY3Rpb24gd2Fzbid0IHJlc2NoZWR1bGVkKSBidXQgd2FzIG9yaWdpbmFsbHkgc2NoZWR1bGVkIGFzIGFuIGFzeW5jXG4gICAgLy8gYWN0aW9uLCB0aGVuIHJlY3ljbGUgYXMgYW4gYXN5bmMgYWN0aW9uLlxuICAgIGlmIChkZWxheSAhPSBudWxsID8gZGVsYXkgPiAwIDogdGhpcy5kZWxheSA+IDApIHtcbiAgICAgIHJldHVybiBzdXBlci5yZWN5Y2xlQXN5bmNJZChzY2hlZHVsZXIsIGlkLCBkZWxheSk7XG4gICAgfVxuICAgIC8vIElmIHRoZSBzY2hlZHVsZXIgcXVldWUgaGFzIG5vIHJlbWFpbmluZyBhY3Rpb25zIHdpdGggdGhlIHNhbWUgYXN5bmMgaWQsXG4gICAgLy8gY2FuY2VsIHRoZSByZXF1ZXN0ZWQgYW5pbWF0aW9uIGZyYW1lIGFuZCBzZXQgdGhlIHNjaGVkdWxlZCBmbGFnIHRvXG4gICAgLy8gdW5kZWZpbmVkIHNvIHRoZSBuZXh0IEFuaW1hdGlvbkZyYW1lQWN0aW9uIHdpbGwgcmVxdWVzdCBpdHMgb3duLlxuICAgIGNvbnN0IHsgYWN0aW9ucyB9ID0gc2NoZWR1bGVyO1xuICAgIGlmIChpZCAhPSBudWxsICYmIGlkID09PSBzY2hlZHVsZXIuX3NjaGVkdWxlZCAmJiBhY3Rpb25zW2FjdGlvbnMubGVuZ3RoIC0gMV0/LmlkICE9PSBpZCkge1xuICAgICAgYW5pbWF0aW9uRnJhbWVQcm92aWRlci5jYW5jZWxBbmltYXRpb25GcmFtZShpZCBhcyBudW1iZXIpO1xuICAgICAgc2NoZWR1bGVyLl9zY2hlZHVsZWQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8vIFJldHVybiB1bmRlZmluZWQgc28gdGhlIGFjdGlvbiBrbm93cyB0byByZXF1ZXN0IGEgbmV3IGFzeW5jIGlkIGlmIGl0J3MgcmVzY2hlZHVsZWQuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuIl19
