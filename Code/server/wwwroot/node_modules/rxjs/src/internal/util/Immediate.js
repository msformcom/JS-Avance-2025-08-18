let nextHandle=1,resolved,activeHandles={};function findAndClearHandle(e){return e in activeHandles&&(delete activeHandles[e],!0)}let Immediate={setImmediate(e){let n=nextHandle++;return activeHandles[n]=!0,(resolved=resolved||Promise.resolve()).then(()=>findAndClearHandle(n)&&e()),n},clearImmediate(e){findAndClearHandle(e)}},TestTools={pending(){return Object.keys(activeHandles).length}};export{Immediate,TestTools};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC91dGlsL0ltbWVkaWF0ZS50cyJdLCJuYW1lcyI6WyJsZXQiLCJuZXh0SGFuZGxlIiwicmVzb2x2ZWQiLCJhY3RpdmVIYW5kbGVzIiwiZmluZEFuZENsZWFySGFuZGxlIiwiaGFuZGxlIiwiSW1tZWRpYXRlIiwic2V0SW1tZWRpYXRlIiwiY2IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJjbGVhckltbWVkaWF0ZSIsIlRlc3RUb29scyIsInBlbmRpbmciLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiQUFBQUEsSUFBSUMsV0FBYSxFQUViQyxTQUNFQyxjQUF3QyxHQU85QyxTQUFTQyxtQkFBbUJDLEdBQzFCLE9BQUlBLEtBQVVGLGdCQUNaLE9BQU9BLGNBQWNFLEdBQ2QsQ0FBQSxFQUdYLENBS08sSUFBTUMsVUFBWSxDQUN2QkMsYUFBYUMsR0FDWCxJQUFNSCxFQUFTSixVQUFVLEdBTXpCLE9BTEFFLGNBQWNFLEdBQVUsQ0FBQSxHQUNuQkgsU0FBQUEsVUFDUU8sUUFBUUMsUUFBTyxHQUVuQkMsS0FBSyxJQUFNUCxtQkFBbUJDLENBQU0sR0FBS0csRUFBRSxDQUFFLEVBQy9DSCxDQUNULEVBRUFPLGVBQWVQLEdBQ2JELG1CQUFtQkMsQ0FBTSxDQUMzQixDLEVBTVdRLFVBQVksQ0FDdkJDLFVBQ0UsT0FBT0MsT0FBT0MsS0FBS2IsYUFBYSxFQUFFYyxNQUNwQyxDLFNBdEJXWCxVQW1CQU8sU0FJWiIsImZpbGUiOiJub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvdXRpbC9JbW1lZGlhdGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgbmV4dEhhbmRsZSA9IDE7XG4vLyBUaGUgcHJvbWlzZSBuZWVkcyB0byBiZSBjcmVhdGVkIGxhemlseSBvdGhlcndpc2UgaXQgd29uJ3QgYmUgcGF0Y2hlZCBieSBab25lc1xubGV0IHJlc29sdmVkOiBQcm9taXNlPGFueT47XG5jb25zdCBhY3RpdmVIYW5kbGVzOiB7IFtrZXk6IG51bWJlcl06IGFueSB9ID0ge307XG5cbi8qKlxuICogRmluZHMgdGhlIGhhbmRsZSBpbiB0aGUgbGlzdCBvZiBhY3RpdmUgaGFuZGxlcywgYW5kIHJlbW92ZXMgaXQuXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiBmb3VuZCwgYGZhbHNlYCBvdGhlcndpc2UuIFVzZWQgYm90aCB0byBjbGVhclxuICogSW1tZWRpYXRlIHNjaGVkdWxlZCB0YXNrcywgYW5kIHRvIGlkZW50aWZ5IGlmIGEgdGFzayBzaG91bGQgYmUgc2NoZWR1bGVkLlxuICovXG5mdW5jdGlvbiBmaW5kQW5kQ2xlYXJIYW5kbGUoaGFuZGxlOiBudW1iZXIpOiBib29sZWFuIHtcbiAgaWYgKGhhbmRsZSBpbiBhY3RpdmVIYW5kbGVzKSB7XG4gICAgZGVsZXRlIGFjdGl2ZUhhbmRsZXNbaGFuZGxlXTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9ucyB0byBzY2hlZHVsZSBhbmQgdW5zY2hlZHVsZSBtaWNyb3Rhc2tzLlxuICovXG5leHBvcnQgY29uc3QgSW1tZWRpYXRlID0ge1xuICBzZXRJbW1lZGlhdGUoY2I6ICgpID0+IHZvaWQpOiBudW1iZXIge1xuICAgIGNvbnN0IGhhbmRsZSA9IG5leHRIYW5kbGUrKztcbiAgICBhY3RpdmVIYW5kbGVzW2hhbmRsZV0gPSB0cnVlO1xuICAgIGlmICghcmVzb2x2ZWQpIHtcbiAgICAgIHJlc29sdmVkID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlc29sdmVkLnRoZW4oKCkgPT4gZmluZEFuZENsZWFySGFuZGxlKGhhbmRsZSkgJiYgY2IoKSk7XG4gICAgcmV0dXJuIGhhbmRsZTtcbiAgfSxcblxuICBjbGVhckltbWVkaWF0ZShoYW5kbGU6IG51bWJlcik6IHZvaWQge1xuICAgIGZpbmRBbmRDbGVhckhhbmRsZShoYW5kbGUpO1xuICB9LFxufTtcblxuLyoqXG4gKiBVc2VkIGZvciBpbnRlcm5hbCB0ZXN0aW5nIHB1cnBvc2VzIG9ubHkuIERvIG5vdCBleHBvcnQgZnJvbSBsaWJyYXJ5LlxuICovXG5leHBvcnQgY29uc3QgVGVzdFRvb2xzID0ge1xuICBwZW5kaW5nKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhhY3RpdmVIYW5kbGVzKS5sZW5ndGg7XG4gIH1cbn07XG4iXX0=
