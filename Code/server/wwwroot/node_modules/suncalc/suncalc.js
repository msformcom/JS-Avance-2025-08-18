(()=>{var w=Math.PI,i=Math.sin,c=Math.cos,u=Math.tan,a=Math.asin,d=Math.atan2,s=Math.acos,p=w/180,e=864e5,t=2440588,r=2451545;function m(n){return new Date((n+.5-t)*e)}function D(n){return n.valueOf()/e-.5+t-r}var o=23.4397*p;function f(n,t){return d(i(n)*c(o)-u(t)*i(o),c(n))}function P(n,t){return a(i(t)*c(o)+c(t)*i(o)*i(n))}function l(n,t,e){return d(i(n),c(n)*i(t)-u(e)*c(t))}function h(n,t,e){return a(i(t)*i(e)+c(t)*c(e)*c(n))}function M(n,t){return p*(280.16+360.9856235*n)-t}function y(n){return p*(357.5291+.98560028*n)}function b(n){return n+p*(1.9148*i(n)+.02*i(2*n)+3e-4*i(3*n))+102.9372*p+w}function g(n){n=b(y(n));return{dec:P(n,0),ra:f(n,0)}}var H={getPosition:function(n,t,e){var e=p*-e,t=p*t,n=D(n),a=g(n),n=M(n,e)-a.ra;return{azimuth:l(n,t,a.dec),altitude:h(n,t,a.dec)}}},T=H.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];function E(n,t,e){return 9e-4+(n+t)/(2*w)+e}function I(n,t,e){return r+n+.0053*i(t)-.0069*i(2*e)}function k(n,t,e,a,r,o,u){return e=e,a=a,I(E(s((i(n)-i(e)*i(a))/(c(e)*c(a))),t,r),o,u)}function v(n){var t=p*(134.963+13.064993*n),e=p*(93.272+13.22935*n),n=p*(218.316+13.176396*n)+6.289*p*i(t),e=5.128*p*i(e),t=385001-20905*c(t);return{ra:f(n,e),dec:P(n,e),dist:t}}function q(n,t){return new Date(n.valueOf()+t*e/24)}H.addTime=function(n,t,e){T.push([n,t,e])},H.getTimes=function(n,t,e,a){for(var r,o,u=p*-e,i=p*t,c=(e=a=a||0,-2.076*Math.sqrt(e)/60),t=D(n),d=Math.round(t-9e-4-u/(2*w)),a=E(0,u,d),s=y(a),f=b(s),l=P(f,0),h=I(a,s,f),M={solarNoon:m(h),nadir:m(h-.5)},g=0,v=T.length;g<v;g+=1)o=k(((r=T[g])[0]+c)*p,u,i,l,d,s,f),M[r[1]]=m(h-(o-h)),M[r[2]]=m(o);return M},H.getMoonPosition=function(n,t,e){var a,e=p*-e,t=p*t,n=D(n),r=v(n),n=M(n,e)-r.ra,e=h(n,t,r.dec),o=d(i(n),u(t)*c(r.dec)-i(r.dec)*c(n));return e+=((a=e)<0&&(a=0),2967e-7/Math.tan(a+.00312536/(a+.08901179))),{azimuth:l(n,t,r.dec),altitude:e,distance:r.dist,parallacticAngle:o}},H.getMoonIllumination=function(n){var n=D(n||new Date),t=g(n),n=v(n),e=s(i(t.dec)*i(n.dec)+c(t.dec)*c(n.dec)*c(t.ra-n.ra)),e=d(149598e3*i(e),n.dist-149598e3*c(e)),t=d(c(t.dec)*i(t.ra-n.ra),i(t.dec)*c(n.dec)-c(t.dec)*i(n.dec)*c(t.ra-n.ra));return{fraction:(1+c(e))/2,phase:.5+.5*e*(t<0?-1:1)/Math.PI,angle:t}},H.getMoonTimes=function(n,t,e,a){for(var r,o,u,i,c,d,s,f,l,h,M,g=new Date(n),v=(a?g.setUTCHours(0,0,0,0):g.setHours(0,0,0,0),.133*p),w=H.getMoonPosition(g,t,e).altitude-v,m=1;m<=24&&(M=H.getMoonPosition(q(g,m),t,e).altitude-v,d=((i=(w+(r=H.getMoonPosition(q(g,m+1),t,e).altitude-v))/2-M)*(c=-(s=(r-w)/2)/(2*i))+s)*c+M,(f=0)<=(s=s*s-4*i*M)&&(l=c-(M=Math.sqrt(s)/(2*Math.abs(i))),h=c+M,Math.abs(l)<=1&&f++,Math.abs(h)<=1&&f++,l<-1)&&(l=h),1===f?w<0?o=m+l:u=m+l:2===f&&(o=m+(d<0?h:l),u=m+(d<0?l:h)),!o||!u);m+=2)w=r;n={};return o&&(n.rise=q(g,o)),u&&(n.set=q(g,u)),o||u||(n[0<d?"alwaysUp":"alwaysDown"]=!0),n},"object"==typeof exports&&"undefined"!=typeof module?module.exports=H:"function"==typeof define&&define.amd?define(H):window.SunCalc=H})();